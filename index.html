
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Limfinity API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;ruby&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="ruby">ruby</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#getting-started" class="toc-h2 toc-link" data-title="getting-started">Getting Started</a>
                  </li>
                  <li>
                    <a href="#what-is-a-user-defined-field-udf" class="toc-h2 toc-link" data-title="what-is-a-user-defined-field-udf">What is a User-Defined Field (UDF)?</a>
                  </li>
                  <li>
                    <a href="#values" class="toc-h2 toc-link" data-title="values">Values</a>
                  </li>
                  <li>
                    <a href="#what-is-a-subject" class="toc-h2 toc-link" data-title="what-is-a-subject">What is a Subject?</a>
                  </li>
                  <li>
                    <a href="#using-subjects-in-scripting" class="toc-h2 toc-link" data-title="using-subjects-in-scripting">Using subjects in scripting</a>
                  </li>
                  <li>
                    <a href="#accessing-entered-values-in-a-form" class="toc-h2 toc-link" data-title="accessing-entered-values-in-a-form">Accessing Entered Values in a Form</a>
                  </li>
                  <li>
                    <a href="#exception-handling" class="toc-h2 toc-link" data-title="exception-handling">Exception Handling</a>
                  </li>
                  <li>
                    <a href="#debugging" class="toc-h2 toc-link" data-title="debugging">Debugging</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#manipulating-subjects" class="toc-h1 toc-link" data-title="manipulating-subjects">Manipulating Subjects</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#get-value" class="toc-h2 toc-link" data-title="get-value">Get Value</a>
                  </li>
                  <li>
                    <a href="#set-value" class="toc-h2 toc-link" data-title="set-value">Set Value</a>
                  </li>
                  <li>
                    <a href="#removing-values" class="toc-h2 toc-link" data-title="removing-values">Removing Values</a>
                  </li>
                  <li>
                    <a href="#naming-subjects" class="toc-h2 toc-link" data-title="naming-subjects">Naming Subjects</a>
                  </li>
                  <li>
                    <a href="#creating-subjects" class="toc-h2 toc-link" data-title="creating-subjects">Creating Subjects</a>
                  </li>
                  <li>
                    <a href="#deleting-subjects" class="toc-h2 toc-link" data-title="deleting-subjects">Deleting Subjects</a>
                  </li>
                  <li>
                    <a href="#copying-properties-from-another-subject" class="toc-h2 toc-link" data-title="copying-properties-from-another-subject">Copying Properties from Another Subject</a>
                  </li>
                  <li>
                    <a href="#setting-permissions" class="toc-h2 toc-link" data-title="setting-permissions">Setting Permissions</a>
                  </li>
                  <li>
                    <a href="#removing-permissions" class="toc-h2 toc-link" data-title="removing-permissions">Removing Permissions</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#workflows-and-states" class="toc-h1 toc-link" data-title="workflows-and-states">Workflows and States</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#starting-workflows" class="toc-h2 toc-link" data-title="starting-workflows">Starting Workflows</a>
                  </li>
                  <li>
                    <a href="#advancing-workflows" class="toc-h2 toc-link" data-title="advancing-workflows">Advancing Workflows</a>
                  </li>
                  <li>
                    <a href="#acquiring-all-subject-states" class="toc-h2 toc-link" data-title="acquiring-all-subject-states">Acquiring All Subject States</a>
                  </li>
                  <li>
                    <a href="#determining-the-current-state-of-a-subject" class="toc-h2 toc-link" data-title="determining-the-current-state-of-a-subject">Determining the Current State of a Subject</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#messages" class="toc-h1 toc-link" data-title="messages">Messages</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#showing-messages" class="toc-h2 toc-link" data-title="showing-messages">Showing Messages</a>
                  </li>
                  <li>
                    <a href="#text-messages-from-input-forms" class="toc-h2 toc-link" data-title="text-messages-from-input-forms">Text Messages from Input Forms</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#user-defined-fields-udfs" class="toc-h1 toc-link" data-title="user-defined-fields-udfs">User Defined Fields (UDFs)</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#changing-the-way-udfs-are-displayed-in-grids" class="toc-h2 toc-link" data-title="changing-the-way-udfs-are-displayed-in-grids">Changing the way UDFs are displayed in grids</a>
                  </li>
                  <li>
                    <a href="#making-udfs-required" class="toc-h2 toc-link" data-title="making-udfs-required">Making UDFs Required</a>
                  </li>
                  <li>
                    <a href="#disabling-udfs-in-forms" class="toc-h2 toc-link" data-title="disabling-udfs-in-forms">Disabling UDFs in Forms</a>
                  </li>
                  <li>
                    <a href="#skipping-hiding-udfs-in-forms" class="toc-h2 toc-link" data-title="skipping-hiding-udfs-in-forms">Skipping/Hiding UDFs in Forms</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#creating-custom-views-and-forms" class="toc-h1 toc-link" data-title="creating-custom-views-and-forms">Creating Custom Views and Forms</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#creating-a-simple-form" class="toc-h2 toc-link" data-title="creating-a-simple-form">Creating a simple form</a>
                  </li>
                  <li>
                    <a href="#creating-a-custom-form" class="toc-h2 toc-link" data-title="creating-a-custom-form">Creating a custom form</a>
                  </li>
                  <li>
                    <a href="#custom-form-with-a-fieldset" class="toc-h2 toc-link" data-title="custom-form-with-a-fieldset">Custom form with a fieldset</a>
                  </li>
                  <li>
                    <a href="#custom-form-with-hide-show-logic" class="toc-h2 toc-link" data-title="custom-form-with-hide-show-logic">Custom form with hide/show logic</a>
                  </li>
                  <li>
                    <a href="#populating-form-fields-with-values-from-other-fields" class="toc-h2 toc-link" data-title="populating-form-fields-with-values-from-other-fields">Populating form fields with values from other fields</a>
                  </li>
                  <li>
                    <a href="#filtering-dropdowns-in-forms" class="toc-h2 toc-link" data-title="filtering-dropdowns-in-forms">Filtering dropdowns in forms</a>
                  </li>
                  <li>
                    <a href="#ui-class-methods" class="toc-h2 toc-link" data-title="ui-class-methods">UI class methods</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#sending-emails" class="toc-h1 toc-link" data-title="sending-emails">Sending Emails</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#sending-an-email-with-a-file-attachment" class="toc-h2 toc-link" data-title="sending-an-email-with-a-file-attachment">Sending an email with a file attachment</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="errors">Errors</a>
          </li>
          <li>
            <a href="#api" class="toc-h1 toc-link" data-title="api">API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#auditrec" class="toc-h2 toc-link" data-title="auditrec">AuditRec</a>
                  </li>
                  <li>
                    <a href="#auth_token" class="toc-h2 toc-link" data-title="auth_token">Auth_token</a>
                  </li>
                  <li>
                    <a href="#users" class="toc-h2 toc-link" data-title="users">Users</a>
                  </li>
                  <li>
                    <a href="#group" class="toc-h2 toc-link" data-title="group">Group</a>
                  </li>
                  <li>
                    <a href="#role" class="toc-h2 toc-link" data-title="role">Role</a>
                  </li>
                  <li>
                    <a href="#userfield" class="toc-h2 toc-link" data-title="userfield">UserField</a>
                  </li>
                  <li>
                    <a href="#subjecttype" class="toc-h2 toc-link" data-title="subjecttype">SubjectType</a>
                  </li>
                  <li>
                    <a href="#subjecttypegroup" class="toc-h2 toc-link" data-title="subjecttypegroup">SubjectTypeGroup</a>
                  </li>
                  <li>
                    <a href="#subject" class="toc-h2 toc-link" data-title="subject">Subject</a>
                  </li>
                  <li>
                    <a href="#audit" class="toc-h2 toc-link" data-title="audit">audit</a>
                  </li>
                  <li>
                    <a href="#users-2" class="toc-h2 toc-link" data-title="users">users</a>
                  </li>
                  <li>
                    <a href="#users_groups" class="toc-h2 toc-link" data-title="users_groups">users_groups</a>
                  </li>
                  <li>
                    <a href="#roles" class="toc-h2 toc-link" data-title="roles">roles</a>
                  </li>
                  <li>
                    <a href="#userfields" class="toc-h2 toc-link" data-title="userfields">userfields</a>
                  </li>
                  <li>
                    <a href="#subject_types" class="toc-h2 toc-link" data-title="subject_types">subject_types</a>
                  </li>
                  <li>
                    <a href="#subject_groups" class="toc-h2 toc-link" data-title="subject_groups">subject_groups</a>
                  </li>
                  <li>
                    <a href="#subjects" class="toc-h2 toc-link" data-title="subjects">subjects</a>
                  </li>
                  <li>
                    <a href="#delete_subject" class="toc-h2 toc-link" data-title="delete_subject">delete_subject</a>
                  </li>
                  <li>
                    <a href="#gen_token" class="toc-h2 toc-link" data-title="gen_token">gen_token</a>
                  </li>
                  <li>
                    <a href="#subject_details" class="toc-h2 toc-link" data-title="subject_details">subject_details</a>
                  </li>
                  <li>
                    <a href="#run_script" class="toc-h2 toc-link" data-title="run_script">run_script</a>
                  </li>
                  <li>
                    <a href="#search_subjects" class="toc-h2 toc-link" data-title="search_subjects">search_subjects</a>
                  </li>
                  <li>
                    <a href="#import_subjects-via-csv" class="toc-h2 toc-link" data-title="import_subjects-via-csv">import_subjects via CSV</a>
                  </li>
                  <li>
                    <a href="#import_subjects-via-json" class="toc-h2 toc-link" data-title="import_subjects-via-json">import_subjects via JSON</a>
                  </li>
                  <li>
                    <a href="#upload_file_udf" class="toc-h2 toc-link" data-title="upload_file_udf">upload_file_udf</a>
                  </li>
                  <li>
                    <a href="#get_pedigree_data" class="toc-h2 toc-link" data-title="get_pedigree_data">get_pedigree_data</a>
                  </li>
                  <li>
                    <a href="#using-auth-token" class="toc-h2 toc-link" data-title="using-auth-token">Using auth Token</a>
                  </li>
                  <li>
                    <a href="#calling-external-apis-with-limfinity" class="toc-h2 toc-link" data-title="calling-external-apis-with-limfinity">Calling External APIs with Limfinity</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#guides" class="toc-h1 toc-link" data-title="guides">Guides</a>
          </li>
          <li>
            <a href="#modelling-your-data-with-limfinity" class="toc-h1 toc-link" data-title="modelling-your-data-with-limfinity">Modelling your data with Limfinity</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#step-1-create-a-new-subject-type" class="toc-h2 toc-link" data-title="step-1-create-a-new-subject-type">Step 1: Create a new Subject Type</a>
                  </li>
                  <li>
                    <a href="#step-2-adding-user-defined-fields-to-your-subject-type" class="toc-h2 toc-link" data-title="step-2-adding-user-defined-fields-to-your-subject-type">Step 2: Adding User-Defined-Fields to your Subject Type</a>
                  </li>
                  <li>
                    <a href="#step-3-creating-a-subject" class="toc-h2 toc-link" data-title="step-3-creating-a-subject">Step 3: Creating a subject</a>
                  </li>
                  <li>
                    <a href="#configuring-the-subject-type-grid" class="toc-h2 toc-link" data-title="configuring-the-subject-type-grid">Configuring the subject type grid</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#creating-workflows" class="toc-h1 toc-link" data-title="creating-workflows">Creating workflows</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#step-1-create-a-new-workflow" class="toc-h2 toc-link" data-title="step-1-create-a-new-workflow">Step 1: Create a new Workflow</a>
                  </li>
                  <li>
                    <a href="#step-2-add-states" class="toc-h2 toc-link" data-title="step-2-add-states">Step 2: Add states</a>
                  </li>
                  <li>
                    <a href="#step-3-adding-a-workflow-transition" class="toc-h2 toc-link" data-title="step-3-adding-a-workflow-transition">Step 3: Adding a workflow transition</a>
                  </li>
                  <li>
                    <a href="#step-4-adding-tool-groups" class="toc-h2 toc-link" data-title="step-4-adding-tool-groups">Step 4: Adding tool groups</a>
                  </li>
                  <li>
                    <a href="#step-5-taking-a-subject-record-through-a-workflow" class="toc-h2 toc-link" data-title="step-5-taking-a-subject-record-through-a-workflow">Step 5: Taking a subject record through a workflow</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Limfinity scripting enables the user to expand out-of-the-box Limfinity framework functionality. Below are a couple examples that can be done
with scripting.</p>
<h2 id='getting-started'>Getting Started</h2>
<p>Any UI element in Limfinity can be configured with a script which will run before or after the UI element is clicked. The Ruby language is used to create scripts in Limfinity. Examples of this include:</p>

<ul>
<li>Creating objects after a button is clicked</li>
<li>Running a search after a dialog is closed</li>
<li>Setting default values</li>
<li>Showing custom error messages</li>
</ul>

<p>You can view all configured scripts in Limfinity by going to &quot;Settings and Preferences&quot; --&gt; More Settings --&gt; All Scripts</p>
<h2 id='what-is-a-user-defined-field-udf'>What is a User-Defined Field (UDF)?</h2>
<p>User-Defined Fields (UDFs) make up the subjects in Limfinity. Each UDF corresponds to a subject property. There are many types of UDFs, each with its own corresponding value types. For example, a “Number” type UDF only supports the entering of numerical values, whereas a “Date” type UDF only supports date format values. UDFs are often set using scripts.</p>
<h2 id='values'>Values</h2>
<p>Values in Limfinity are defined as the generic objects which are to be manipulated. Values can be user-defined fields, standard fields, names, and IDs.</p>
<h2 id='what-is-a-subject'>What is a Subject?</h2>
<p>A subject is a Limfinity object with defined fields and values. A subject can have any number of fields, including collections of other subjects. Subjects are the core objects in Limfinity which are manipulated and handled to store data.
Subjects can be of any type which has been defined in the Limfinity system, and there is no limit to the number of subjects which can be created. Subjects store data in standard and user-defined fields, and progress through respective workflows.</p>
<h2 id='using-subjects-in-scripting'>Using subjects in scripting</h2>
<p>“Subj” is a Limfinity term which refers to the currently opened subject. For example, when working with
 a sample subject record, “subj” in a script in that record’s window will refer to that subject. Any <code>get_value()</code> calls will refer to the data within that subject.</p>
<h2 id='accessing-entered-values-in-a-form'>Accessing Entered Values in a Form</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Populate the subject with values from a form, unless the value in the form is blank</span>
<span class="n">params</span><span class="p">.</span><span class="nf">each_pair</span><span class="p">{</span><span class="o">|</span><span class="n">udf</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">value</span><span class="p">.</span><span class="nf">present?</span>
    <span class="n">subj</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="n">udf</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="n">subj</span><span class="p">.</span><span class="nf">remove_prop</span><span class="p">(</span><span class="n">udf</span><span class="p">)</span>
  <span class="k">end</span>
<span class="p">}</span>
</code></pre>
<p>It is sometimes necessary to get the value of a field object in a script for variable assignment or storage. When manipulating a subject in a script, the <code>get_value()</code> method is used. However if a script is being run without a subject object, for example when entering information into a form via a Quick Link, then the <code>params[]</code> call is used. The <code>params[]</code> call obtains the value which is entered into the form, respective to each field.</p>
<h3 id='parameters'>Parameters</h3><pre class="highlight ruby tab-ruby"><code><span class="c1"># Using the params[:required] script will ensure that each UDF with a "true" parameter must have a value</span>
<span class="c1"># before the form can be submitted.</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:required</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Chem Analyses'</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
    <span class="s1">'Chemistry Package'</span> <span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">}</span>
</code></pre>
<p>Parameters are accessed in a similar way as fields with already set values. The standard syntax for obtaining a parameter’s information is params[‘FIELD NAME’]. This call is very useful when creating a subject. The params[] call may be used within a set_value() method call, where the parameter may be the value to set.</p>
<h2 id='exception-handling'>Exception Handling</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># The raise method is used for exception handling, and is also good for debugging</span>
<span class="c1"># Here we raise the value of the "Sample Type" UDF of the opened subject to see its value in a new window</span>
<span class="k">raise</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Sample Type'</span><span class="p">)</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we raise an error message if the value of the "PH Level" UDF is higher than 7</span>
<span class="k">if</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'PH Level'</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span>
    <span class="k">raise</span> <span class="s2">"PH level is too high"</span>
<span class="k">end</span>
</code></pre>
<p>Limfinity supports the Ruby “Raise” method, which is used for handling exceptions. When an exception (error) needs to be handled, the raise method is an excellent tool. When an exception is handled using the raise method, the script in Limfinity will cease running, and as a result no actions will have been performed.</p>

<p>The raise method can be used for exception handling, and for logic and value checking. In this example, an error message is thrown if the value of the subject’s “PH Level” is higher than 7.</p>
<h2 id='debugging'>Debugging</h2>
<p>The <code>inspect</code> method can be called on a subject to provide output of a specified value inside a <code>raise</code> statement. This is equivalent to calling <code>to_json</code> on a Limfinity object.
The <code>raise</code> method can be used to break out of a script and display a message.</p>
<h3 id='to-troubleshoot-an-error-thrown-by-limfinity'>To troubleshoot an error thrown by Limfinity:</h3>
<ul>
<li>Copy the error message out of the error dialog</li>
<li>Go to <code>Settings and Preferences</code>, choose <code>System Preferences</code> and click on <code>VM Console Log</code>
<img src="images/guides/vm_console_log_loc.png" alt="VM Console Log Location" /></li>
<li>Scroll to the bottom of the console log (the latest errors will show up on the bottom)
<img src="images/guides/vm_console.png" alt="VM Console Log" /></li>
<li>If the error message is not at the bottom of the console log, click <code>Ctrl+F</code> to paste the copied error message into the search box</li>
<li>Once you have located the error message in the console log, take note of the line number and the script name where the error was originated. The stack trace accompanying the error will be shown below the error in the console log.</li>
<li>Apply the fix to the script referenced in the console log and perform the action again.</li>
</ul>
<h1 id='manipulating-subjects'>Manipulating Subjects</h1><h2 id='get-value'>Get Value</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># In this example, a variable ‘age’ is set to the value of the subject’s “Age” user-defined field.</span>
 <span class="n">age</span> <span class="o">=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Age'</span><span class="p">)</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># This subject is a "Testing Run". A testing run can have a sample, which can have its own information</span>
<span class="c1">#  This call will obtain the value of the dilution of the sample within the testing run</span>
<span class="c1">#It is possible to “chain” get_value() method calls for downstream objects. In this example, the value of a</span>
<span class="c1">#testing run’s sample’s dilution is obtained. There is no limit to the number of get_value() chains that may</span>
<span class="c1">#be called.</span>
<span class="n">dilution</span> <span class="o">=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Sample'</span><span class="p">).</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Dilution'</span><span class="p">)</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># The object 'Samples' is a collection of sample subjects, therefore it is stored in an array.</span>
<span class="c1"># A get_value() method call can be used to obtain teh collection of sample subjects.</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Samples'</span><span class="p">)</span>

<span class="c1">#For example, the destroy method will destroy the first sample (index) in the samples array,</span>
<span class="c1"># As designated by the [0]. Note that array indeces start at 0.</span>
<span class="n">samples</span><span class="p">.</span><span class="nf">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">destroy</span>

<span class="c1">#Loops can also be used to perform actions on all elements in the array.</span>
<span class="n">samples</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">example</span><span class="o">|</span>
  <span class="n">example</span><span class="p">.</span><span class="nf">destroy</span>
<span class="k">end</span>
</code></pre>
<p>Returns a value of a property. The get_value() method is used for obtaining a value of a subject’s or several subjects’ user-defined fields.
This method gets the value of the defined parameter, and stores it in any variable to which it is assigned.</p>
<h3 id='defining-subject-subj'>Defining Subject - “Subj”</h3>
<p>“Subj” is a Limfinity term which refers to the currently opened subject. For example, when working with a
sample subject record, “subj” in a script in that record’s window will refer to that subject. Any get_value()
calls will refer to the data within that subject.</p>
<h3 id='parameters-2'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>property</td>
<td>The value of the property to retrieve</td>
</tr>
</tbody></table>

<p>It is possible to “chain” get_value() method calls for downstream objects. There is no limit to the number of get_value() chains that may be called.</p>

<p>Arrays are collections of data, therefore the get_value() method call can be used to obtain the value of the collection.</p>

<p>Note that in order to perform any action on an element in the array, a loop must be used for a single index that must be defined</p>

<aside class="notice">
Note that it is necessary to add a ruby suffix to the <code>get_value()</code> method call when a specific value or type conversion is necessary. For example, in the example above if it were necessary to get the absolute last value in the array, but the size of the array was unknown, it would be necessary to use <code>subj.get_value(‘Samples’).last</code>.
</aside>
<h2 id='set-value'>Set Value</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Example: Setting a single value</span>
<span class="c1"># Set_value takes two parameters. The first parameter is the value (Request Method), and the second is the intended value (Metagenomics).</span>
<span class="c1"># Here we set the request method for the subject to Metagenomics.</span>
  <span class="n">subj</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Request Method'</span><span class="p">,</span> <span class="s1">'Metagenomics'</span><span class="p">)</span>

<span class="c1"># Chaining get_value() to set_value()</span>
<span class="c1"># In this example, a subject has a reference subject called “First Analysis”. The “First Analysis” subject has a subject called “First Sample”.</span>
<span class="c1"># With this chained call, the “First Sample” subject is having its “Sample Name” UDF assigned the value of “Example”, even though that subject is not currently opened on the screen.</span>
<span class="c1"># set_value() can be chained together after a get_value()</span>
<span class="c1"># Here we get the field "First Sample" from the field of a referenced subject "First Analysis" of the opened subject,</span>
<span class="c1"># and set the value of that first sample's UDF "Sample Name" to "Example".</span>
<span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'First Analysis'</span><span class="p">).</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'First Sample'</span><span class="p">).</span><span class="nf">set_value</span><span class="p">(</span><span class="s2">"Sample Name"</span><span class="p">,</span> <span class="s2">"Example"</span><span class="p">)</span>

<span class="c1"># Looping set_value()</span>
<span class="c1"># Loops are very useful when it is necessary to set the value of a field for several subjects</span>
<span class="c1"># Here we get the array of analyses of this subject, loop through each one, and set the UDF value "Checked" to "Yes"</span>
<span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Analyses'</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">analysis</span><span class="o">|</span>
  <span class="n">analysis</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Checked?'</span><span class="p">,</span> <span class="s1">'Yes'</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
<p>The <code>set_value()</code> method is used for setting the value of a subject’s or several subjects’ user-defined fields. The method accepts two parameters, the first of which is the field to be set, and the second of which is the intended value.</p>
<h3 id='parameters-3'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>property</td>
<td>The intended property to be set</td>
</tr>
<tr>
<td>value</td>
<td>The intended value for the property</td>
</tr>
</tbody></table>
<h2 id='removing-values'>Removing Values</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># This example has the user select a Test Panel that will have all associated Lab Tests removed</span>
<span class="n">panel</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Select Panel to Clear Tests From'</span><span class="p">]</span>
<span class="n">panel</span><span class="p">.</span><span class="nf">remove_prop</span><span class="p">(</span><span class="s1">'Lab Tests'</span><span class="p">)</span>
</code></pre>
<p>The <code>remove_prop()</code> method is used to clear the contents of user defined fields within a subject. The <code>remove_prop()</code> method is executed on the subject that calls the method. Note that the UDF is not permanently removed from the subject; <code>remove_prop()</code> method clears the value currently stored in the UDF for calling subject.</p>
<h3 id='parameters-4'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>property</td>
<td>The value of the property to clear</td>
</tr>
</tbody></table>
<h2 id='naming-subjects'>Naming Subjects</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Example: Overriding the Name of a Subject</span>

<span class="c1"># To set the name of a subject, an assignment operation can be used. Note that subject names must always be unique.</span>
<span class="c1"># Here we overwrite the name of the subject by appending the current date and time to it.</span>
<span class="c1"># Using the current date and time is a good way to ensure that the name of the subject remains unique.</span>
<span class="n">subj</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="p">(</span><span class="n">subj</span><span class="p">.</span><span class="nf">name</span> <span class="o">+</span> <span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1">#  Example: get_next_name_number</span>

<span class="c1"># Using the get_next_name_number is another way to ensure that a subject’s name remains unique. This method can be used when creating a subject or reassigning its name.</span>
<span class="c1"># Here we use the get_next_name_number method to ensure the subject's name is unique</span>
<span class="s2">"Sample "</span> <span class="o">+</span> <span class="s1">'-'</span> <span class="o">+</span> <span class="p">(</span><span class="s2">"%05d"</span><span class="o">%</span> <span class="n">subject_type</span><span class="p">.</span><span class="nf">get_next_name_number</span><span class="p">)</span>
</code></pre>
<p>Subjects can be named in a variety of ways in Limfinity. For example, names can be generated via the subject type’s extension, or they can be set manually during a subject edit, or they may be modified using a simple assignment operation.</p>

<aside class="notice">
It is important to derive a consistent naming convention for subjects when configuring Limfinity  software. Subjects with consistent names will be easier to work with and search for in Limfinity, and will
be easier to modify via scripts as well. Consider positive naming conventions and schemas prior to configuring Limfinity.
</aside>
<pre class="highlight ruby tab-ruby"><code><span class="n">params</span><span class="p">[</span><span class="ss">:display_field</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">'Submission'</span> <span class="o">=&gt;</span> <span class="s1">'Submission Name'</span>
<span class="p">}</span>
</code></pre><h3 id='using-params-display_field-in-before-script'>Using params[:display_field] in Before Script</h3>
<p>User can choose any ‘Text Field’ UDF as a display option for linked subject(s) instead of the
system generated ‘Name’ field.</p>
<h2 id='creating-subjects'>Creating Subjects</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we create a subject, and within a loop set a few of its UDF values</span>
<span class="c1"># Note that the UDF values are being set to the values which have been entered into the form by using the params[] objects</span>
<span class="n">subject</span> <span class="o">=</span> <span class="n">create_subject</span><span class="p">(</span><span class="s1">'Job'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">jb</span><span class="o">|</span>
  <span class="n">jb</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Client'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Client'</span><span class="p">])</span>
  <span class="n">jb</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'# of Samples'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'# of Samples'</span><span class="p">])</span>
<span class="k">end</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we call the create_subject method and create a subject of type "QC Sample"</span>
<span class="c1"># Using the open_subject() method call, the created subject will be opened.</span>

<span class="n">subject</span> <span class="o">=</span> <span class="n">create_subject</span><span class="p">(</span><span class="s1">'QC Sample'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">qc</span><span class="o">|</span>
  <span class="n">qc</span><span class="p">.</span><span class="nf">name</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span>
  <span class="n">qc</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Lot #'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Lot #'</span><span class="p">])</span>
<span class="k">end</span>

<span class="n">open_subject</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
</code></pre>
<p>To create subjects via scripts in Limfinity, the <code>create_subject()</code> method is called. The <code>create_subject()</code> method is often called using a loop, so as to create multiple subjects, or to assign values to the subject which is being created.</p>

<p>It is often the intent to create a subject and immediately begin working on it, however the <code>create_subject()</code> method call only creates the subject. In order to open the subject to immediately view it and work with it after it has been created, the <code>open_subject()</code> method call is used.</p>
<h3 id='parameters-5'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>subject_type</td>
<td>The subject type of which the subject is to be created.</td>
</tr>
</tbody></table>
<h2 id='deleting-subjects'>Deleting Subjects</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we delete each sample associated with the subject</span>

<span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="n">samples</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">sample</span><span class="o">|</span>
  <span class="n">sample</span><span class="p">.</span><span class="nf">destroy</span>
<span class="k">end</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="k">def</span> <span class="nf">before_delete_action</span>
  <span class="kp">false</span>
<span class="k">end</span>
</code></pre>
<p>To delete subjects in Limfinity, the destroy() method is used. Calling the destroy() method will delete the subject from the database. The associated information and user-defined field data will be deleted as well.</p>

<aside class="notice">
Only use the destroy() method when it is confirmed that the subject is to be completed removed from the database. The destroy() method will remove the object and associated object information from the database.
</aside>
<h3 id='prevent-deleted-subjects'>Prevent Deleted Subjects</h3>
<p>Add a method to Subject Type Subject Extension to prevent a user deleting any related subject/s by any means.</p>
<h2 id='copying-properties-from-another-subject'>Copying Properties from Another Subject</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we create a new family, and copy the properties of it from an existing family (subject)</span>
<span class="n">familyname</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Family'</span><span class="p">]</span>

<span class="n">patient</span> <span class="o">=</span> <span class="n">create_subject</span><span class="p">(</span><span class="s1">'Patient'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
    <span class="nb">p</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Family'</span><span class="p">,</span> <span class="n">familyname</span><span class="p">)</span>
    <span class="nb">p</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'UDP Inquiry'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="nb">p</span><span class="p">.</span><span class="nf">copy_properties_from</span><span class="p">(</span><span class="n">subj</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
<p>To copy properties from one subject to another, the copy_properties_from() method is used. This method is useful for duplicating subjects, and creating new subjects with existing data.</p>

<p>aside class=&quot;notice&quot;&gt;
Copying properties works simply by taking a subject (user-defined field) and duplicating that data into another subject.
</aside></p>
<h2 id='setting-permissions'>Setting Permissions</h2><pre class="highlight ruby tab-ruby"><code><span class="n">ug</span> <span class="o">=</span> <span class="no">UserGroup</span><span class="p">.</span><span class="nf">find_by_name</span><span class="p">(</span><span class="s1">'Users'</span><span class="p">)</span>
<span class="nb">sub</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Project'</span><span class="p">]</span>
<span class="n">subj</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Project'</span><span class="p">,</span> <span class="nb">sub</span><span class="p">)</span>
<span class="c1"># Acl::NOACCESS, Acl::READONLY, ACL::READWRITE</span>
<span class="no">Acl</span><span class="p">.</span><span class="nf">set_permissions</span><span class="p">(</span><span class="nb">sub</span><span class="p">,</span> <span class="n">ug</span><span class="p">,</span> <span class="no">Acl</span><span class="o">::</span><span class="no">READWRITE</span><span class="p">)</span>
</code></pre>
<p>The <code>set_permission</code> method is used to set a permission flag on an object for a user group. The following parameter definitions for the parameters are explained below:</p>

<ul>
<li>NOACCESS – Specifies a user group which has a designated access level of “no access”</li>
<li>READONLY – Specifies a user group which has a designated access level of “view only”</li>
<li>READWRITE – Specifies a user group which has a designated access level of “full access”</li>
</ul>

<p>The syntax for the <code>Acl.set_permission</code> method is as follows:</p>

<p><code>Acl.set_permission(subject, user_group, NOACCESS/READONLY/READWRITE)</code></p>

<p>The following After Script is used to give <code>READWRITE</code> permission to subject type- subject ‘Project’ for
user group <strong>‘Users’</strong>. The subject type ‘Project’ is set as <strong>‘READONLY’</strong> for user group <strong>‘Users’</strong></p>
<h2 id='removing-permissions'>Removing Permissions</h2><pre class="highlight ruby tab-ruby"><code><span class="n">ug</span> <span class="o">=</span> <span class="no">UserGroup</span><span class="p">.</span><span class="nf">find_by_name</span><span class="p">(</span><span class="s1">'Users'</span><span class="p">)</span>
<span class="nb">sub</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Project'</span><span class="p">]</span>
<span class="n">subj</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Project'</span><span class="p">,</span> <span class="nb">sub</span><span class="p">)</span>
<span class="c1"># Acl::NOACCESS, Acl::READONLY, ACL::READWRITE</span>
<span class="no">Acl</span><span class="p">.</span><span class="nf">remove_permission</span><span class="p">(</span><span class="nb">sub</span><span class="p">,</span> <span class="n">ug</span><span class="p">)</span>
</code></pre>
<p>The <code>remove_permission</code> method is used to remove a permission flag on an object for a user group. The syntax for the <code>Acl.remove_permission</code> method is as follows:</p>

<p><code>Acl.remove_permission(subject, user_group)</code></p>
<h1 id='workflows-and-states'>Workflows and States</h1>
<p>Workflows and states are the core of the Limfinity platform. Workflows dictate what types of objects can be manipulated, when they can be manipulated, and how. Workflows are the main engine in Limfinity and explain the individual processes which each object goes through.</p>
<h2 id='starting-workflows'>Starting Workflows</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># The start_workflow() method is used to start the workflow for a newly created subject</span>
<span class="c1"># param1 - Name of the workflow as defined in the system</span>
<span class="c1"># param2 - Subject for which the workflow should be started</span>

<span class="n">patient</span> <span class="o">=</span> <span class="n">create_subject</span><span class="p">(</span><span class="s1">'Patient'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="nb">p</span><span class="o">|</span>
    <span class="nb">p</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Family'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Family'</span><span class="p">])</span>
<span class="k">end</span>

<span class="n">start_workflow</span><span class="p">(</span><span class="s1">'Patient Workflow'</span><span class="p">,</span> <span class="n">patient</span><span class="p">)</span>
</code></pre>
<p>When a subject is created, it needs to be placed into a workflow. The <code>start_workflow()</code> method is called to perform this. The <code>start_workflow()</code> method takes two parameters: the first parameter is the name of the workflow, and the second parameter is the subject for which the workflow should be started.</p>

<p>There are two parameters required for the <code>start_workflow()</code> method:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Workflow</strong></td>
<td>Name of the workflow as defined in the system</td>
</tr>
<tr>
<td><strong>Subject</strong></td>
<td>Subject for which the workflow should be started</td>
</tr>
</tbody></table>
<h2 id='advancing-workflows'>Advancing Workflows</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Iterate over a set of subjects and create a new subject with the same properties</span>
<span class="c1"># Place the subject into a 'Batched' state in the `Result` workflow</span>
<span class="n">spikes</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">spike</span><span class="o">|</span>
    <span class="n">new_result</span> <span class="o">=</span> <span class="n">create_subject</span><span class="p">(</span><span class="s1">'Result'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">rz</span><span class="o">|</span>
      <span class="n">rz</span><span class="p">.</span><span class="nf">copy_properties_from</span><span class="p">(</span><span class="n">spike</span><span class="p">)</span>
      <span class="n">rz</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Result Type'</span><span class="p">,</span> <span class="s1">'SAMPLE SPIKE'</span><span class="p">)</span>
    <span class="k">end</span>
    <span class="n">advance_workflow</span><span class="p">(</span><span class="s1">'Result'</span><span class="p">,</span> <span class="s1">'Batched'</span><span class="p">,</span> <span class="n">new_result</span><span class="p">)</span>
<span class="k">end</span>

</code></pre>
<p>When a workflow has been started, or when it is in progress, it may be necessary to set a subject or list of subjects to a specific state. This can be done in any after script or run script, and so it can be performed in tools, workflow transitions, and even quick links.</p>

<aside class="warning">
Advancing workflows requires the correct subject type and workflow combination. A subject of a type not supported for a workflow can not be advanced to a state within that workflow.
</aside>

<p>There are three parameters for the <code>advance_workflow()</code> method:</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Workflow</strong></td>
<td>The name of the Workflow in Limfinity</td>
</tr>
<tr>
<td><strong>Workflow State</strong></td>
<td>The name of the state to which the subject should be advanced, within the workflow</td>
</tr>
<tr>
<td><strong>Subject</strong></td>
<td>The subject object/loop index which is to be advanced.</td>
</tr>
</tbody></table>
<h2 id='acquiring-all-subject-states'>Acquiring All Subject States</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we check to see if the subject has been in more than 5 states</span>
<span class="c1"># If the subject has been in more than 5 states, an error is raised</span>

<span class="n">states_array</span> <span class="o">=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">states</span>

<span class="k">if</span> <span class="n">states_array</span><span class="p">.</span><span class="nf">count</span> <span class="o">&gt;</span> <span class="mi">5</span>
    <span class="k">raise</span> <span class="s2">"This subject has been in too many states"</span>
<span class="k">end</span>
</code></pre>
<p>If it is ever necessary to acquire a list of the states that a subject has been in during its lifetime, the states method may be used. A simple <code>subj.states</code> call may be used on the current subject, and an array of the subject’s states will be returned.
This method is useful for quality control, but may also be used for checking if a subject has been in a specific state by using additional scripting.</p>
<h2 id='determining-the-current-state-of-a-subject'>Determining the Current State of a Subject</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we use the current_states method to check if the subject is in a specific state</span>
<span class="k">if</span> <span class="n">subject</span><span class="p">.</span><span class="nf">current_states</span> <span class="o">=</span> <span class="s2">"Pending Approval"</span>
    <span class="k">raise</span> <span class="s2">"This subject is currently in the 'Pending Approval' state"</span>
<span class="k">end</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we advance the subject through a workflow, if its array of states includes 'HOLD'</span>
<span class="n">note</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Employee Notes'</span><span class="p">]</span>
<span class="n">subj</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Employee Notes'</span><span class="p">,</span> <span class="n">note</span><span class="p">)</span> <span class="k">if</span> <span class="n">note</span><span class="p">.</span><span class="nf">present?</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Samples'</span><span class="p">)</span>
<span class="n">samples</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">sample</span><span class="o">|</span>
    <span class="n">advance_workflow</span><span class="p">(</span><span class="s1">'Sample'</span><span class="p">,</span> <span class="s1">'Received'</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>
<span class="k">end</span>
<span class="n">advance_workflow</span><span class="p">(</span><span class="s1">'Sample Prep'</span><span class="p">,</span> <span class="s1">'MICRO'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span> <span class="k">if</span> <span class="n">subj</span><span class="p">.</span><span class="nf">current_states</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:name</span><span class="p">).</span><span class="nf">include?</span><span class="p">(</span><span class="s1">'HOLD'</span><span class="p">)</span>
</code></pre>
<p>It is often necessary to determine the current state of a subject. In order to successfully obtain the current state of an object, the <code>current_states</code> method is used. This method may be used in a check or in conjunction with an array index.</p>
<h1 id='messages'>Messages</h1>
<p>There are two different types of messages, which can be displayed via scripts in Limfinity: messages and alerts. Messages are displayed in confirmation dialogs, which the user must interact with, and alerts are displayed in a dropdown message for a short amount of time.</p>
<h2 id='showing-messages'>Showing Messages</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#  Example: Showing Messages</span>
<span class="c1">#Here we use the show_message() method to provide the user with a simple output message</span>
<span class="n">show_message</span><span class="p">(</span><span class="s2">"All samples have been selected for analyses. Please click 'OK' to proceed."</span><span class="p">)</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1">#  Example: Showing Alerts</span>
<span class="c1"># Here we provide the user with a simple alert message, which they do not need to acknowledge</span>
<span class="n">show_alert</span><span class="p">(</span><span class="s2">"You are now in the next workflow state"</span><span class="p">)</span>
</code></pre>
<p>Messages with confirmation dialogs are shown using the show_message() in After Script tab. The user will be required to click a confirmation “OK” button to acknowledge that they have seen the message. show_message() dialogs are shown after all other code has been executed.</p>

<aside class="notice">
Messages are different from alerts in one way, in that messages require the acknowledgement of the message via a confirmation selection. Alerts are shown in a dropdown textbox for only a short period of time.
</aside>

<aside class="notice">
There is only a single parameter for the show_message() method, and that is the message itself. The message must be typed in quotes, as such: “Example”.
</aside>
<h2 id='text-messages-from-input-forms'>Text Messages from Input Forms</h2><pre class="highlight ruby tab-ruby"><code><span class="n">params</span><span class="p">[</span><span class="ss">:tab_name</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Samples'</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:subject_type</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'Sample'</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:query</span><span class="p">]</span> <span class="o">=</span> <span class="n">search_query</span> <span class="k">do</span> <span class="o">|</span><span class="n">qb</span><span class="o">|</span>
    <span class="n">qb</span><span class="p">.</span><span class="nf">and</span><span class="p">(</span>
      <span class="n">qb</span><span class="p">.</span><span class="nf">state</span><span class="p">(</span><span class="s1">'Results Entry'</span><span class="p">)</span>
    <span class="p">)</span>
<span class="k">end</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:hint_msg</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'&lt;p style="color:red"&gt;List of Samples.&lt;/p&gt;'</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:tb_items</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
   <span class="p">{</span><span class="ss">xtype: </span><span class="s1">'box'</span><span class="p">,</span> <span class="ss">html: </span><span class="s1">''</span><span class="o">&lt;</span><span class="n">span</span> <span class="n">style</span> <span class="o">=</span><span class="p">\</span><span class="s1">'color:darkgreen\'&gt;Result Entry State&lt;/span&gt;'</span><span class="p">}</span>
<span class="p">]</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we use a tool message to inform the user. THis message will be displayed in the tool itself</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:tool</span> <span class="n">_message</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Prior to performing this action, ensure that all other actions are complete"</span>
</code></pre>
<p>Text messages can be added to input forms by using the <code>:tool_message</code> parameter.
<aside class="notice">
The :tool_message parameter must be added to the “Before Script” of a tool or transition. With this tool, text is added to a form which will be displayed.
</aside></p>

<aside class="notice">
The :hint_msg and :tb_items parameters can be added to “Before Script” which will be displayed in the tool bar of any subject list.
</aside>

<p><img src="images/guides/toolbar_message.png" alt="Subject List with toolbar message" /></p>

<aside class="notice">
There is a single difference between a tool message and a show message, and that is that tool messages are shown in combination with the confirmation dialog of a tool, rather than after the confirmation dialog has been closed.
</aside>
<h1 id='user-defined-fields-udfs'>User Defined Fields (UDFs)</h1>
<p>User-Defined Fields (UDFs) make up the subjects in Limfinity. There are many types of UDFs, each with its own corresponding value types. For example, a “Number” type UDF only supports the entering of numerical values, whereas a “Date” type UDF only supports date format values. UDFs are often set using scripts.</p>
<h2 id='changing-the-way-udfs-are-displayed-in-grids'>Changing the way UDFs are displayed in grids</h2><pre class="highlight javascript tab-javascript"><code><span class="k">if</span> <span class="p">(</span><span class="nx">value</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span>  <span class="s1">'&lt;span style="color:blue;font-weight:bold;"&gt; No &lt;/span&gt;'</span>
<span class="p">}</span> <span class="k">else</span> <span class="k">return</span> <span class="s1">'&lt;span style="color:red;font-weight:bold;"&gt; '</span><span class="o">+</span><span class="nx">val</span><span class="o">+</span><span class="s1">' &lt;/span'</span>
</code></pre>
<p><img src="images/guides/grid_renderer.png" alt="Grid Renderer (JavaScript)" /></p>

<p><img src="images/guides/grid_renderer_in_explorer.png" alt="Explorer Subject List View using Grid Renderer" /></p>
<h2 id='making-udfs-required'>Making UDFs Required</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Using the params[:required] script will ensure that each UDF with a 'true' parameter must have a value before the form can be submitted</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:required</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Chem Analyses'</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span>
    <span class="s1">'Chemistry Package'</span> <span class="o">=&gt;</span> <span class="kp">true</span>
<span class="p">}</span>
</code></pre>
<p>It is often necessary to make sure a UDF has a corresponding value when a form is being completed. Furthermore, it may be necessary to ensure that a value has been entered prior to the form submission completion. Using the <code>params[:required]</code> in <strong>Before Script</strong> can accomplish this.</p>
<h2 id='disabling-udfs-in-forms'>Disabling UDFs in Forms</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we disable the 'Submitter Name' UDF, as it should be a read-only UDF</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:disabled</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'Submitter Name'</span><span class="o">=&gt;</span><span class="kp">true</span>
<span class="p">}</span>
</code></pre>
<p>UDFs can be disabled in forms by using the <code>params[:disabled]</code> parameter in <strong>Before Script.</strong> This parameter is used when specific UDFs in a form should be disabled, in order to enforce read-only access to the user.</p>
<h2 id='skipping-hiding-udfs-in-forms'>Skipping/Hiding UDFs in Forms</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Here we skip the 'Submitter Name' UDF if it already has an entry</span>
<span class="k">if</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Submitter Name'</span><span class="p">).</span><span class="nf">present?</span>
    <span class="n">params</span><span class="p">[</span><span class="ss">:skip_UDF</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s1">'Submitter Name'</span> <span class="o">=&gt;</span> <span class="kp">true</span>
    <span class="p">}</span>
<span class="k">end</span>
</code></pre>
<p>It is possible to skip or hide a UDF when editing a subject form, by using the <code>params[:skip_UDF]</code> parameter. This is a very useful tool when logic is involved when editing a subject.</p>

<aside class="notice">
As with most other parameter tools, the params[:skip_UDF] parameter must be entered in the “Before Script” of a tool or transition.
</aside>
<h1 id='creating-custom-views-and-forms'>Creating Custom Views and Forms</h1>
<p>Custom views and forms may be created in Limfinity, in lieu of the default form formatting. By default, Limfinity
will build a default form containing all the UDFs that were passed in as parameters to the tool. The parameter UDFs
can be modified in before and after scripts (making fields required or disabled, adding input validation, etc). However, it is possible
to completely override the default form look and feel by replacing it with your own custom view.</p>
<h2 id='creating-a-simple-form'>Creating a simple form</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Before script: Open a form when on or more sample records are selected in the grid. Display a dialog with storage fields</span>
<span class="k">raise</span> <span class="s2">"Please select at least one sample"</span> <span class="k">unless</span> <span class="n">subjects</span><span class="p">.</span><span class="nf">length</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="n">params</span><span class="p">[</span><span class="ss">:dialog_options</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="ss">maximizable: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">resizable: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">layout: </span><span class="err">‘</span><span class="n">fit</span><span class="err">’</span><span class="p">}</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:required</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">'Freezer'</span><span class="o">=&gt;</span><span class="kp">true</span><span class="p">,</span>
<span class="s1">'Rack'</span><span class="o">=&gt;</span><span class="kp">true</span><span class="p">,</span>
<span class="s1">'Shelf'</span><span class="o">=&gt;</span><span class="kp">true</span><span class="p">,</span>
<span class="s1">'Date Stored'</span><span class="o">=&gt;</span><span class="kp">true</span>
</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># After script: Update each selected sample with storage information from the form and update their status. Display alert to the user when operation is completed.</span>
<span class="n">subjects</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Freezer'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Freezer'</span><span class="p">])</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Rack'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Rack'</span><span class="p">])</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Shelf'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Shelf'</span><span class="p">])</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Box'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Box'</span><span class="p">])</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Slot'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Slot'</span><span class="p">])</span>
  <span class="n">s</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Date Stored'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">'Date Stored'</span><span class="p">])</span>

  <span class="n">advance_workflow</span><span class="p">(</span><span class="s1">'Sample'</span><span class="p">,</span> <span class="s1">'Stored'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">show_alert</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">subjects</span><span class="p">.</span><span class="nf">length</span><span class="si">}</span><span class="s2"> Samples successfully stored to </span><span class="si">#{</span><span class="n">params</span><span class="p">[</span><span class="s1">'Freezer'</span><span class="p">].</span><span class="nf">name</span><span class="si">}</span><span class="s2">"</span> <span class="p">)</span>
</code></pre>
<ol>
<li>Create a quick link or a workflow tool</li>
<li>Enter UDF names into the <code>Script Parameters</code> field (these UDFs must already exist in Limfinity)
<img src="images/guides/script_params.png" alt="Script Parameters" /></li>
<li>Create a before script (if you would like to apply attributes to the UDFs), or perform validation.</li>
<li>Create an after script with the funcionality that needs to happen after the user clicks on the tool (this can be creation of new subjects, updating data, or displaying alerts)</li>
</ol>

<p>In this example, we are using <code>params[:dialog_options] = {maximizable: true, resizable: true, layout: ‘fit’}</code> to create a resizable dialog.</p>

<p><img src="images/guides/store_sample.png" alt="Store sample" /></p>
<h2 id='creating-a-custom-form'>Creating a custom form</h2><pre class="highlight ruby tab-ruby"><code><span class="kp">extend</span> <span class="no">ScriptRunner</span><span class="o">::</span><span class="no">UI</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:custom_fields</span><span class="p">]</span> <span class="o">=</span> <span class="n">encode_fields</span><span class="p">([</span><span class="n">item1</span><span class="p">,</span> <span class="n">item2</span><span class="p">.</span><span class="nf">.</span><span class="o">.</span><span class="p">])</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:submit_disabled_as_empty</span><span class="p">]</span> <span class="o">=</span> <span class="kp">true</span>
</code></pre>
<p>In order to create custom forms and UIs, a few scripts must be used. The layout form the form can either be defined in the before script, or in a helper script (if the layout is very complicated).
view. A before script and after script are necessary for the tool. Once these three scripts are written
and in place, the custom form may be used.</p>

<aside class="notice">
You must override the default fields by providing an array of items as the <code>custom_fields</code> property.
</aside>

<p>To create a custom form:</p>

<ol>
<li>Create a quick link or a workflow tool</li>
<li>Right-click on the workflow tool and click on <strong>Before Script</strong></li>
<li>You must extend  the <code>ScriptRunner:UI</code> class</li>
<li>Create an array of items that you want to display as fields on the form, and encode them by using the <code>encode_fields</code> method</li>
<li>You must set the value of <code>params[:custom_fields]</code> property to the value returned by the <code>encode_fields</code></li>
<li>If you wish to submit disabled fields as empty values, you can use the property <code>params[:submit_disabled_as_empty]</code></li>
</ol>
<h2 id='custom-form-with-a-fieldset'>Custom form with a fieldset</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># This example creates a form with multiple fieldsets and rows containing UDFs</span>
<span class="kp">extend</span> <span class="no">ScriptRunner</span><span class="o">::</span><span class="no">UI</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:custom_fields</span><span class="p">]</span> <span class="o">=</span>  <span class="n">encode_fields</span><span class="p">([</span>
  <span class="n">field_set</span><span class="p">(</span><span class="n">title</span><span class="ss">:'2012-0846'</span><span class="p">,</span> <span class="n">items</span><span class="p">:[</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Patient Name'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'MRN_Number'</span><span class="p">,</span><span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Consenting Protocol'</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">150</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="s1">'PSC Date'</span><span class="p">,</span> <span class="n">subj</span><span class="p">),</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'PSC Type'</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">flex</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Principal Investigator'</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">150</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Title'</span><span class="p">,</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Consenting Protocol'</span><span class="p">))</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
    <span class="n">udf</span><span class="p">(</span><span class="s1">'Requesting Investigator'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="p">(</span><span class="n">udf</span><span class="s1">'Surgery Date'</span><span class="p">,</span> <span class="n">subj</span><span class="p">),</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Surgeon'</span><span class="p">,</span> <span class="n">subj</span><span class="p">),</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Building ID'</span><span class="p">,</span> <span class="n">subj</span><span class="p">),</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Room ID'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Preliminary Diagnosis'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">])</span>
  <span class="p">]),</span>
  <span class="n">field_set</span><span class="p">(</span><span class="n">title</span><span class="ss">:'Tissue Specific Information'</span><span class="p">,</span> <span class="n">items</span><span class="p">:[</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Sample Type'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="s1">'Organ/Sites'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="s1">'Processing Details'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">])</span>
  <span class="p">]),</span>
  <span class="n">field_set</span><span class="p">(</span><span class="n">title</span><span class="ss">:'Special Instructions'</span><span class="p">,</span> <span class="n">items</span><span class="p">:[</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Special Instructions'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
  <span class="n">field_set</span><span class="p">(</span><span class="n">title</span><span class="ss">:'Pickup Information'</span><span class="p">,</span> <span class="n">items</span><span class="p">:[</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Pick Up Date/Time'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">]),</span>
    <span class="n">field_row</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Contact for Pickup'</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span>
    <span class="p">])</span>
  <span class="p">])</span>
<span class="p">])</span>
</code></pre>
<p>This example demonstrates how to create a form with multiple fieldsets and multiple rows. Each row is created
by calling <code>field_row</code> and passing it one or more udfs.</p>

<p><img src="images/guides/form_with_fieldsets.png" alt="Form with multiple fieldsets" /></p>
<h2 id='custom-form-with-hide-show-logic'>Custom form with hide/show logic</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># Create a custom form with a radio button and a field set. Here we want to show the field set only when</span>
<span class="c1"># the value of the 'Find Requsitions' radio button is 'Submitted'</span>
<span class="kp">extend</span> <span class="no">ScriptRunner</span><span class="o">::</span><span class="no">UI</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:custom_fields</span><span class="p">]</span> <span class="o">=</span> <span class="n">encode_fields</span><span class="p">([</span>
    <span class="n">udf</span><span class="p">(</span><span class="s1">'Find Requisitions'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">required</span><span class="ss">:false</span><span class="p">),</span>
    <span class="n">field_set</span><span class="p">(</span><span class="n">title</span><span class="ss">:'Find By Properities'</span><span class="p">,</span> <span class="n">border</span><span class="ss">:'1 0 0 0'</span><span class="p">,</span> <span class="n">items</span><span class="p">:[</span>
        <span class="n">udf</span><span class="p">(</span><span class="s1">'External Source ID'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">info</span><span class="ss">:'This field can be used for the Sample Barcode Entry'</span><span class="p">,</span>
          <span class="n">allowCreate</span><span class="ss">:false</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">anchor</span><span class="ss">:'100%'</span><span class="p">),</span>
        <span class="n">udf</span><span class="p">(</span><span class="s1">'Requisition'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">allowCreate</span><span class="ss">:false</span><span class="p">),</span>
        <span class="n">udf</span><span class="p">(</span><span class="s1">'Patient'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">allowCreate</span><span class="ss">:false</span><span class="p">),</span>
        <span class="n">udf</span><span class="p">(</span><span class="s1">'Requesting Physician'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">allowCreate</span><span class="ss">:false</span><span class="p">),</span>
        <span class="n">udf</span><span class="p">(</span><span class="s1">'Collection Date'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">anchor</span><span class="ss">:'50%'</span><span class="p">),</span>
      <span class="p">],</span>
      <span class="ss">react: </span><span class="p">{</span>
        <span class="ss">shown_when: </span><span class="s1">'value == "Submitted"'</span><span class="p">,</span>
        <span class="ss">only: </span><span class="s1">'Find Requisitions'</span>
    <span class="p">})</span>
  <span class="p">])</span>
</code></pre>
<p>You can attach listeners to any field by using the <code>react</code> property. In this example, we will hide/show a fieldset based on a value
of a radio button. In order to hide or show a component you must use the <code>shown_when</code> property, and pass it an expression which evaluates to true or false.
The <code>only</code> property can specify a component that the field will listen to. If <code>only</code> is missing, the field will listen to changes on all
fields on the form.</p>

<p><img src="images/guides/find_requisitions.png" alt="Find Requisitions" /></p>
<h2 id='populating-form-fields-with-values-from-other-fields'>Populating form fields with values from other fields</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># In this example we first pick a Billing Facility, and then auto-populate the Billing Facility Address field with the</span>
<span class="c1"># value of the facility's address stored in the database.</span>
<span class="n">field_container</span><span class="p">([</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Billing Facility'</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="ss">required: </span><span class="kp">true</span><span class="p">,</span> <span class="n">allowCreate</span><span class="ss">:false</span><span class="p">,</span> <span class="ss">filter: </span><span class="s2">"</span><span class="si">#{</span><span class="n">facility_filter</span><span class="si">}</span><span class="s2">"</span><span class="p">),</span>
      <span class="n">udf</span><span class="p">(</span><span class="s1">'Billing Facility Address'</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">anchor</span><span class="ss">:'100%'</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="ss">required: </span><span class="kp">true</span><span class="p">,</span> <span class="n">validateAddress</span><span class="ss">:true</span><span class="p">,</span> <span class="n">react</span><span class="p">:{</span>
        <span class="n">change</span><span class="ss">:'form.setValuesAsync({id: value, udfs: {"Address":"Billing Facility Address"}})'</span><span class="p">,</span>
        <span class="ss">only: </span><span class="s1">'Billing Facility'</span>
      <span class="p">})</span>
    <span class="p">],</span>
    <span class="ss">react: </span><span class="p">{</span>
      <span class="ss">shown_when: </span><span class="s2">"value == 'Facility'"</span><span class="p">,</span>
      <span class="ss">only: </span><span class="s1">'Bill To'</span>
    <span class="p">}</span>
<span class="p">)</span>
</code></pre>
<p>This example demonstrates how you can populate fields with values from another field. You can use the <code>change</code> listener to
call either <code>setValue</code> or <code>setValuesAsync</code> (if you want to suspend listeners while the form is being populated).</p>
<h2 id='filtering-dropdowns-in-forms'>Filtering dropdowns in forms</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># In this example we only want to show tests that are already on the requisition, and are applicable to all specimen types or our specimen types</span>
<span class="n">udf</span><span class="p">(</span><span class="s1">'Tests'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">value</span><span class="ss">:tests</span><span class="p">,</span> <span class="n">required</span><span class="ss">:true</span><span class="p">,</span> <span class="n">allowCreate</span><span class="ss">:false</span><span class="p">,</span>
    <span class="ss">filter: </span><span class="s2">"&lt;-Requisition::</span><span class="se">\"</span><span class="s2">Tests</span><span class="se">\"</span><span class="s2"> = </span><span class="si">#{</span><span class="n">req</span><span class="p">.</span><span class="nf">id</span><span class="si">}</span><span class="s2"> AND (</span><span class="se">\"</span><span class="s2">Specimen Types</span><span class="se">\"</span><span class="s2"> = </span><span class="si">#{</span><span class="n">specimen</span><span class="p">.</span><span class="nf">id</span><span class="si">}</span><span class="s2"> OR </span><span class="se">\"</span><span class="s2">Specimen Types</span><span class="se">\"</span><span class="s2"> = null)"</span><span class="p">,</span>
    <span class="ss">react: </span><span class="p">{</span>
      <span class="ss">change: </span><span class="s2">"
        this.setFilter(</span><span class="se">\'</span><span class="s2">&lt;-Requisition::</span><span class="se">\"</span><span class="s2">Tests</span><span class="se">\"</span><span class="s2"> = </span><span class="si">#{</span><span class="n">req</span><span class="p">.</span><span class="nf">id</span><span class="si">}</span><span class="s2"> AND (</span><span class="se">\"</span><span class="s2">Specimen Type</span><span class="se">\"</span><span class="s2"> = </span><span class="se">\'</span><span class="s2">+value+' OR </span><span class="se">\"</span><span class="s2">Specimen Types</span><span class="se">\"</span><span class="s2"> = null)');
        this.setValue(</span><span class="si">#{</span><span class="n">tests_by_specimen</span><span class="p">.</span><span class="nf">to_json</span><span class="si">}</span><span class="s2">[value]);"</span><span class="p">,</span>
      <span class="ss">only: </span><span class="s1">'Specimen Type'</span>
    <span class="p">}),</span>
<span class="c1"># Here we only want to see tests that are not archived and are orderable (i.e clients can order them)</span>
<span class="n">udf</span><span class="p">(</span><span class="s1">'Non-Orderable Tests'</span><span class="p">,</span> <span class="kp">nil</span><span class="p">,</span> <span class="n">value</span><span class="ss">:non_orderable_tests</span><span class="p">,</span> <span class="ss">filter: </span><span class="s1">'terminated = false AND "Non-Orderable" = true'</span><span class="p">,</span> <span class="n">allowCreate</span><span class="ss">:false</span><span class="p">),</span>
</code></pre>
<p>This example demonstrates how you can filter the values of dropdowns by a criteria or an expression. There are multiple ways to set filters.</p>

<ol>
<li>The simplest way to filter something is to set the <code>filter</code> property on a UDF, like so: <code>filter:&quot;terminated is false&quot;,</code>.</li>
<li>You can plug in your variables into the ruby template by following this example: <code>filter:&quot;Facility = #{facility ? facility.id : 0} and terminated is false&quot;</code></li>
<li>You can also pass in a filter expression like so: <code>filter: &quot;#{facility_filter}&quot;)</code></li>
<li>Filter by state: <code>filter: &quot;#state = Active&quot;&quot;</code></li>
</ol>
<h2 id='ui-class-methods'>UI class methods</h2><pre class="highlight ruby tab-ruby"><code><span class="n">udf</span><span class="p">(</span><span class="s1">'Requesting Physician'</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="ss">addCustomFields: </span><span class="n">physician_layout</span><span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">,</span> <span class="n">required</span><span class="ss">:true</span><span class="p">,</span>
  <span class="n">filter</span><span class="ss">:"Facility = </span><span class="si">#{</span><span class="n">facility</span> <span class="p">?</span> <span class="n">facility</span><span class="p">.</span><span class="nf">id</span> <span class="p">:</span> <span class="mi">0</span><span class="si">}</span><span class="ss"> and terminated is false"</span><span class="p">,</span>
  <span class="ss">react: </span><span class="p">{</span>
    <span class="ss">shown_when: </span><span class="s1">'value'</span><span class="p">,</span>
    <span class="ss">change: </span><span class="s2">"this.setFilter('terminated is false and Facility='+(value || 0));"</span><span class="p">,</span>
    <span class="n">only</span><span class="ss">:'Facility'</span>
<span class="p">}),</span>
</code></pre><h3 id='udf'>udf</h3>
<p>Creates a UDF (user defined field).</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:name</td>
<td>UDF name</td>
</tr>
<tr>
<td>:subj</td>
<td>Subject containing the UDF</td>
</tr>
<tr>
<td>:options</td>
<td>The options object</td>
</tr>
</tbody></table>
<pre class="highlight ruby tab-ruby"><code> <span class="n">field_row</span><span class="p">([</span>
  <span class="n">udf</span><span class="p">(</span><span class="s1">'Decimal Places'</span><span class="p">,</span> <span class="n">subj</span><span class="p">),</span>
  <span class="n">udf</span><span class="p">(</span><span class="s1">'Unit'</span><span class="p">,</span> <span class="n">subj</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">60</span><span class="p">)</span>
<span class="p">]),</span>
</code></pre><h3 id='field_row'>field_row</h3>
<p>Creates a field row by taking an array of fields and laying them out in one  row</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:items</td>
<td>Array of items to place into a form row</td>
</tr>
<tr>
<td>:options</td>
<td>The options object</td>
</tr>
</tbody></table>
<pre class="highlight ruby tab-ruby"><code><span class="n">field_container</span><span class="p">(</span><span class="n">fields</span><span class="p">,</span> <span class="ss">defaults: </span><span class="p">{</span><span class="n">anchor</span><span class="ss">:'100%'</span><span class="p">,</span> <span class="n">labelWidth</span><span class="p">:</span><span class="mi">160</span><span class="p">},</span> <span class="n">react</span><span class="p">:{</span>
  <span class="ss">init: </span><span class="s1">'this.setDisabled(!value)'</span><span class="p">,</span>
  <span class="ss">only: </span><span class="s1">'Patient'</span>
<span class="p">})</span>
</code></pre><h3 id='field_container'>field_container</h3>
<p>Lays out passed in items in a field container. Useful if you want to apply the same styling to all items within a container</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:items</td>
<td>Array of items to place into a form row</td>
</tr>
<tr>
<td>:options</td>
<td>The options object</td>
</tr>
</tbody></table>
<pre class="highlight ruby tab-ruby"><code><span class="c1"># Example fieldset</span>
<span class="n">field_set</span><span class="p">(</span><span class="n">title</span><span class="ss">:'General Information'</span><span class="p">,</span> <span class="n">border</span><span class="ss">:'1 0 0 0'</span><span class="p">,</span> <span class="n">defaults</span><span class="p">:{</span><span class="n">anchor</span><span class="ss">:'100%'</span><span class="p">},</span> <span class="n">items</span><span class="ss">:[]</span><span class="p">)</span>
</code></pre><h3 id='field_set'>field_set</h3>
<p>Creates a ExtJs 4.2.2 fieldset with the given options</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:options</td>
<td>The options object</td>
</tr>
</tbody></table>
<h3 id='choice_by_query'>choice_by_query</h3>
<p>Creates a Choice type UDF but with the drop-down list filled by query</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:name</td>
<td>The UDF name</td>
</tr>
<tr>
<td>:subj</td>
<td>Subject containing the UDF</td>
</tr>
<tr>
<td>:query</td>
<td>The query object that will produce a set of results to populate the picklist</td>
</tr>
<tr>
<td>:options</td>
<td>The options object to pass to the picklist</td>
</tr>
</tbody></table>
<h3 id='custom_radio_group'>custom_radio_group</h3>
<p>Creates a radio group from given options</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:args</td>
<td>A configuration object, consisting of args[0] = name for the radio group and args[1] = the options object.</td>
</tr>
</tbody></table>

<p>The options object can contain an <code>items</code> property with each item having a <code>name</code> and <code>checked</code> properties.</p>
<h3 id='udfs_for_subject_type'>udfs_for_subject_type</h3>
<p>Returns a list of UDFs that exist for a given subject type in Limfinity</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:st</td>
<td>The subject type</td>
</tr>
<tr>
<td>:subj</td>
<td>Subject containing the UDF</td>
</tr>
<tr>
<td>:customizations</td>
<td>Object containing any additional properties for the UDFs such as &quot;readOnly&quot;, or &quot;anchor</td>
</tr>
</tbody></table>
<pre class="highlight ruby tab-ruby"><code><span class="n">subj</span> <span class="o">=</span> <span class="no">UI</span><span class="p">.</span><span class="nf">add_subject</span><span class="p">(</span><span class="s1">'Analyte'</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="p">{</span><span class="ss">name: </span><span class="nb">name</span><span class="p">})</span>
</code></pre><h3 id='add_subject'>add_subject</h3>
<p>Creates a subject populated with the values from the params</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:st</td>
<td>The subject type</td>
</tr>
<tr>
<td>:params</td>
<td>The params (usually from the custom form/view)</td>
</tr>
<tr>
<td>:options</td>
<td>The options object</td>
</tr>
</tbody></table>
<pre class="highlight ruby tab-ruby"><code><span class="no">UI</span><span class="p">.</span><span class="nf">save_subject</span><span class="p">(</span><span class="n">subj</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="nb">name</span> <span class="o">!=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">name</span> <span class="p">?</span> <span class="p">{</span><span class="ss">name: </span><span class="nb">name</span><span class="p">}</span> <span class="p">:</span> <span class="p">{})</span>
</code></pre><h3 id='save_subject'>save_subject</h3>
<p>Saves a subject populated with the values from the params. This method performs access controlled read and write operations, and
writes to the audit trail.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:subject</td>
<td>The subject to save</td>
</tr>
<tr>
<td>:params</td>
<td>The params (usually from the custom form/view)</td>
</tr>
<tr>
<td>:options</td>
<td>The options object. If the options object contains &quot;name&quot; or &quot;gen:name&quot; properties, they will be used to create a new subject name</td>
</tr>
</tbody></table>
<pre class="highlight ruby tab-ruby"><code> <span class="n">opts</span> <span class="o">=</span> <span class="n">count</span> <span class="p">?</span> <span class="p">{</span><span class="ss">count: </span><span class="n">count</span><span class="p">}</span> <span class="p">:</span> <span class="p">{}</span>
 <span class="no">ScriptRunner</span><span class="o">::</span><span class="no">UI</span><span class="o">::</span><span class="n">search_tab_link</span><span class="p">(</span><span class="n">subj_type_name</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="s2">"style=</span><span class="se">\"</span><span class="s2">color:white; text-decoration:none;</span><span class="se">\"</span><span class="s2"> onmouseover=</span><span class="se">\"</span><span class="s2">this.style.color='black'</span><span class="se">\"</span><span class="s2">  onmouseout=</span><span class="se">\"</span><span class="s2">this.style.color='white'</span><span class="se">\"</span><span class="s2">"</span><span class="p">,</span> <span class="n">tab_name</span><span class="p">,</span> <span class="n">opts</span><span class="p">)</span>
</code></pre><h3 id='search_tab_link'>search_tab_link</h3>
<p>Generates a link opening a search tab or showing &#39;0&#39; if nothing found</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:subject_type_name</td>
<td>The subject type to search</td>
</tr>
<tr>
<td>:query</td>
<td>The query to run the search</td>
</tr>
<tr>
<td>:tab_opts</td>
<td>Object containing tab parameters</td>
</tr>
<tr>
<td>:link_attrs</td>
<td>Link attributes</td>
</tr>
<tr>
<td>:tab_anem</td>
<td>Name for the new tab</td>
</tr>
</tbody></table>
<pre class="highlight ruby tab-ruby"><code><span class="c1">#Example for Group Edit Component - display grid</span>
<span class="c1"># Displays a grid with 4 rows, each containing an editable collection kit record</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:tool_message</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Create up to 5 Collection Kits&lt;br&gt;&lt;br&gt;"</span>
<span class="kp">extend</span> <span class="no">ScriptRunner</span><span class="o">::</span><span class="no">UI</span>
<span class="n">column_configs</span> <span class="o">=</span>  <span class="p">{</span>
    <span class="s1">'Quantity'</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">minValue: </span><span class="mi">1</span><span class="p">}</span>
  <span class="p">}</span>

<span class="n">params</span><span class="p">[</span><span class="ss">:custom_fields</span><span class="p">]</span> <span class="o">=</span> <span class="n">encode_fields</span><span class="p">([</span>
   <span class="n">group_editor</span><span class="p">(</span><span class="s1">'Add_Collection_Kits'</span><span class="p">,</span> <span class="p">[</span>
     <span class="p">{</span><span class="mi">0</span><span class="o">=&gt;</span><span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Facility'</span><span class="p">),</span> <span class="mi">3</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">},</span>
     <span class="p">{</span><span class="mi">0</span><span class="o">=&gt;</span><span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Facility'</span><span class="p">),</span> <span class="mi">3</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">},</span>
     <span class="p">{</span><span class="mi">0</span><span class="o">=&gt;</span><span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Facility'</span><span class="p">),</span> <span class="mi">3</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">},</span>
     <span class="p">{</span><span class="mi">0</span><span class="o">=&gt;</span><span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Facility'</span><span class="p">),</span> <span class="mi">3</span><span class="o">=&gt;</span><span class="mi">0</span><span class="p">}</span>
     <span class="p">],</span> <span class="ss">name: </span><span class="s1">'custom[data]'</span><span class="p">,</span> <span class="ss">flex: </span><span class="mi">1</span><span class="p">)</span>
<span class="p">])</span>
<span class="n">params</span><span class="p">[</span><span class="ss">:custom_fields_place</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'top'</span>

</code></pre><pre class="highlight ruby tab-ruby"><code><span class="c1"># script here to process the data from the Group Edit table</span>
<span class="c1"># This script reads all the data out of each row and creates one collection kit per row</span>
<span class="c1"># The editable fields are defined in the "Add Collection Kits" workflow tool</span>
<span class="kp">extend</span> <span class="no">ScriptRunner</span><span class="o">::</span><span class="no">UI</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">parse_group_edit_data</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">'data'</span><span class="p">])</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span>
  <span class="n">quantity</span>  <span class="o">=</span> <span class="n">row</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">row</span><span class="p">.</span><span class="nf">keys</span><span class="p">.</span><span class="nf">find</span><span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span><span class="nb">p</span><span class="p">[</span><span class="ss">:display_name</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Quantity'</span><span class="p">})</span>
  <span class="n">specimen_type</span> <span class="o">=</span> <span class="n">row</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">row</span><span class="p">.</span><span class="nf">keys</span><span class="p">.</span><span class="nf">find</span><span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span><span class="nb">p</span><span class="p">[</span><span class="ss">:display_name</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Specimen Type'</span><span class="p">})</span>
  <span class="n">facility</span> <span class="o">=</span> <span class="n">row</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">row</span><span class="p">.</span><span class="nf">keys</span><span class="p">.</span><span class="nf">find</span><span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span><span class="nb">p</span><span class="p">[</span><span class="ss">:display_name</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Facility'</span><span class="p">})</span>
  <span class="n">components</span> <span class="o">=</span> <span class="n">row</span><span class="p">.</span><span class="nf">fetch</span><span class="p">(</span><span class="n">row</span><span class="p">.</span><span class="nf">keys</span><span class="p">.</span><span class="nf">find</span><span class="p">{</span><span class="o">|</span><span class="nb">p</span><span class="o">|</span><span class="nb">p</span><span class="p">[</span><span class="ss">:display_name</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Kit Components'</span><span class="p">})</span>

  <span class="k">if</span> <span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="n">quantity</span>
        <span class="n">kit</span> <span class="o">=</span> <span class="n">create_subject</span><span class="p">(</span><span class="s1">'Collection Kit'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">kit</span><span class="o">|</span>
        <span class="n">kit</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Facility'</span><span class="p">,</span> <span class="n">facility</span><span class="p">)</span>
        <span class="n">kit</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Specimen Type'</span><span class="p">,</span> <span class="n">specimen_type</span><span class="p">)</span>
        <span class="n">kit</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'Kit Components'</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
        <span class="n">kit</span><span class="p">.</span><span class="nf">advance_workflow</span><span class="p">(</span><span class="s1">'Collection Kit'</span><span class="p">,</span> <span class="s1">'Requested'</span><span class="p">)</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
      <span class="k">end</span>
    <span class="k">end</span>
 <span class="k">end</span>
  <span class="k">end</span>
<span class="n">show_alert</span><span class="p">(</span><span class="s2">"Created </span><span class="si">#{</span><span class="n">count</span><span class="si">}</span><span class="s2"> Collection Kits"</span><span class="p">)</span> <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span>
</code></pre><h3 id='group_editor'>group_editor</h3>
<p>Embeds an editable grid within a dialog</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:tool</td>
<td>The instance of the subject group edit tool defined in the workflow builder</td>
</tr>
<tr>
<td>:content</td>
<td>An array containing the configuration for each row that will be displayed in the embedded grid.</td>
</tr>
<tr>
<td>:options</td>
<td>An array of options: payloads, column configs or anything else that needs to be passed ot the component</td>
</tr>
</tbody></table>
<h3 id='select_template_field'>select_template_field</h3>
<p>?????????????</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:subject_type</td>
<td>The name of the subject type</td>
</tr>
<tr>
<td>:options</td>
<td>An array of options</td>
</tr>
</tbody></table>
<h3 id='select_printer_field'>select_printer_field</h3>
<p>?????????????</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:options</td>
<td>An array of options</td>
</tr>
</tbody></table>
<h1 id='sending-emails'>Sending Emails</h1><pre class="highlight ruby tab-ruby"><code><span class="c1"># In this example, an array of recipients is first create,d and then an email is setn to the recipients using an email template by the name of "Example Template", regarding the opened subject</span>
<span class="c1"># Create an array of recipients</span>
<span class="n">recipients</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Add all members of the "User Group 1" group to the recipients array</span>
<span class="n">recipients</span> <span class="o">&lt;&lt;</span> <span class="n">find_user_group</span><span class="p">(</span><span class="s1">'User Group 1)
# Add all members of the "User Group 2" group to the recipients array
recipients &lt;&lt; find_user_group('</span><span class="no">User</span> <span class="no">Group</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Send an email using the email template "Example Template" regarding the current subject</span>
<span class="n">send_email</span><span class="p">(</span> <span class="n">recipients</span> <span class="p">,</span> <span class="n">find_email_template</span><span class="p">(</span><span class="s1">'Example Template'</span><span class="p">),</span> <span class="n">subj</span><span class="p">)</span>
</code></pre>
<p>Limfinity supports the automatic sending of emails through scripts, if the installation is set up with proper emailing credentials. The <code>send_email()</code> method is used to send emails to users with registered email addresses to their user accounts.</p>

<aside class="notice">
The send_email() method takes three parameters. The first parameter is the recipient or list of recipients. The second parameter is the email template, found by name in the system. The final parameter is the subject.
</aside>

<aside class="notice">
Note that an email template is always required to send an email. Email templates must be created in the system in order to successfully send an email.
</aside>

<p>In this example, an array of recipients is first created. Recipients can be specific users, or entire user groups. User groups are added to the recipients array in this case.
After the recipients have been assigned, the <code>send_email()</code> method is called. The method takes the first parameter of the recipients, the second of the defined email template, and the last parameter of the opened subject.
*Note that an email template is always required to send an email. Email templates must be created in the system in order to successfully send an email.</p>
<h2 id='sending-an-email-with-a-file-attachment'>Sending an email with a file attachment</h2><pre class="highlight ruby tab-ruby"><code><span class="c1"># recipient email address</span>
<span class="n">email_addr</span> <span class="o">=</span> <span class="s1">'test@ruro.com'</span>

<span class="c1"># This is the email template in the system</span>
<span class="n">template</span> <span class="o">=</span> <span class="s2">"Email Test"</span>

<span class="c1"># This is the 'File' UDF set in the 'Script Parameter'</span>
<span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">'ATTACHED FILE'</span><span class="p">].</span><span class="nf">present?</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">'ATTACHED FILE'</span><span class="p">]</span>
    <span class="n">subj</span><span class="p">.</span><span class="nf">set_value</span><span class="p">(</span><span class="s1">'ATTACHED FILE'</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># the attached file</span>
<span class="n">rfile</span> <span class="o">=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'ATTACHED FILE'</span><span class="p">)</span>

<span class="n">send_email</span><span class="p">(</span><span class="n">email_addr</span><span class="p">,</span> <span class="n">template</span><span class="p">,</span> <span class="n">subj</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">e</span><span class="o">|</span>
    <span class="n">e</span><span class="p">.</span><span class="nf">add_attachment</span><span class="p">(</span><span class="n">rfile</span><span class="p">,</span> <span class="n">rfile</span><span class="p">.</span><span class="nf">to_s</span><span class="p">,</span> <span class="n">rfile</span><span class="p">.</span><span class="nf">to_json</span><span class="p">[</span><span class="s1">'mime_type'</span><span class="p">])</span>
<span class="k">end</span>

<span class="n">show_message</span><span class="p">(</span><span class="s1">'Email sent'</span><span class="p">)</span>
</code></pre>
<p>Files can be attached to the email using ‘File’ UDF.  When creating the email workflow tool, the field ‘Script Parameter’, which is the ‘File’ UDF, needs to be selected.  The After Script will contain the reference of the script parameters.</p>
<h1 id='errors'>Errors</h1>
<p><aside class="notice">This error section is stored in a separate file in <code>includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files...just save them to the <code>includes</code> folder and add them to the top of your <code>index.md</code>&#39;s frontmatter. Files are included in the order listed.</aside></p>

<p>The Lifinity API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- The request is incorrect.</td>
</tr>
</tbody></table>
<h1 id='api'>API</h1>
<p><strong>List of Objects Supported by Limfinity API</strong>
<aside class="notice">
Following is a list of Objects and their identifying values that are called by supported methods. Scroll down for a list of corresponding methods.
</aside></p>
<h2 id='auditrec'>AuditRec</h2>
<p>A record of any change within the system.</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of an audit record.</td>
</tr>
<tr>
<td>:obj_name</td>
<td>Name of the changed object.</td>
</tr>
<tr>
<td>:user</td>
<td>The name of the user that made the change.</td>
</tr>
<tr>
<td>:obj_type</td>
<td>The type of the object changed.</td>
</tr>
<tr>
<td>:created_at</td>
<td>The date the audit record was created.</td>
</tr>
<tr>
<td>:message</td>
<td>The action performed that created the audit.</td>
</tr>
<tr>
<td>:comments</td>
<td>Any user-generated comment added when the audited action was performed.</td>
</tr>
</tbody></table>
<h2 id='auth_token'>Auth_token</h2>
<p>An authorization token used in place of a user’s password for API calls. Using the auth_token will omit the “API Session Created” and “API Session Removed” entries in the audit log.</p>
<h2 id='users'>Users</h2>
<p>Uniquely identifies a user in the system:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of a user.</td>
</tr>
<tr>
<td>:username</td>
<td>User’s Login name.</td>
</tr>
<tr>
<td>:fullname</td>
<td>User’s full name.</td>
</tr>
<tr>
<td>:email</td>
<td>User’s email.</td>
</tr>
<tr>
<td>:created_at</td>
<td>Date when the user was created in the system.</td>
</tr>
<tr>
<td>:roles</td>
<td>Roles assigned to the user.</td>
</tr>
<tr>
<td>:disabled</td>
<td>Defines whether the user is currently disabled.</td>
</tr>
<tr>
<td>:locked =</td>
<td>Defines whether the user is currently locked.</td>
</tr>
<tr>
<td>:active</td>
<td>Defines whether the user is currently active.</td>
</tr>
<tr>
<td>:groups</td>
<td>List of User Groups this user belongs to.</td>
</tr>
</tbody></table>
<h2 id='group'>Group</h2>
<p>Uniquely identifies a user group in the system:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of a user group.</td>
</tr>
<tr>
<td>:name</td>
<td>User group’s name.</td>
</tr>
<tr>
<td>:description</td>
<td>Description of the group.</td>
</tr>
<tr>
<td>:created_at</td>
<td>Date when the group was created in the system.</td>
</tr>
<tr>
<td>:created_by</td>
<td>User name who created this group.</td>
</tr>
<tr>
<td>:updated_at</td>
<td>Date when the group was last updated.</td>
</tr>
<tr>
<td>:users-count</td>
<td>Number of users in the group.</td>
</tr>
<tr>
<td>:baseline</td>
<td>Placeholder text.</td>
</tr>
</tbody></table>
<h2 id='role'>Role</h2>
<p>A role that defines the access permissions in the system:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of a role.</td>
</tr>
<tr>
<td>:name</td>
<td>Role’s name.</td>
</tr>
<tr>
<td>:rights</td>
<td>A list of rights assigned to the role.</td>
</tr>
<tr>
<td>:baseline</td>
<td>Placeholder text.</td>
</tr>
<tr>
<td>:created_at</td>
<td>Date when the role was created in the system.</td>
</tr>
<tr>
<td>:system_role</td>
<td>Defines whether the role is internal (built-into the software) or user-defined.</td>
</tr>
</tbody></table>
<h2 id='userfield'>UserField</h2>
<p>A user-defined field in the system:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of a user-defined field.</td>
</tr>
<tr>
<td>:name</td>
<td>Internal name of the user-defined field.</td>
</tr>
<tr>
<td>:display_name</td>
<td>Display (human readable) name of user-defined field.</td>
</tr>
<tr>
<td>:type</td>
<td>User-defined field type (“Date”, “Text Field”, “Text Area”, “Checkbox”, etc.) :searchable = Defines whether the user-defined field is searchable.</td>
</tr>
<tr>
<td>:values</td>
<td>User-defined field values.</td>
</tr>
<tr>
<td>:created_at</td>
<td>Date when the user-defined field was created in the system.</td>
</tr>
<tr>
<td>:updated_at</td>
<td>Date when the user-defined field was last updated.</td>
</tr>
<tr>
<td>:created_by</td>
<td>User name who created this user-defined field.</td>
</tr>
<tr>
<td>:used_by</td>
<td>Which objects use the user-defined field.</td>
</tr>
<tr>
<td>:permission</td>
<td>Permissions applicable to the user calling a method which returns this object.</td>
</tr>
</tbody></table>
<h2 id='subjecttype'>SubjectType</h2>
<p>A user-defined subject type in the system:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of a subject type.</td>
</tr>
<tr>
<td>:name</td>
<td>Internal name of the subject type.</td>
</tr>
<tr>
<td>:descr</td>
<td>Description of the subject type.</td>
</tr>
<tr>
<td>:color</td>
<td>Color of the icon representing the subject type.</td>
</tr>
<tr>
<td>:searchable_quick</td>
<td>Defines whether the subject type may be found in a quick search. :searchable_advanced = Defines whether the subject type may be found in an advanced search. :searchable_batch = Defines whether the subject type may be found in a batch search.</td>
</tr>
<tr>
<td>:fields</td>
<td>List of user-defined properties.</td>
</tr>
<tr>
<td>:searchable</td>
<td>The subject type is searchable within the system.</td>
</tr>
<tr>
<td>:syslock</td>
<td>Indicates if the object is “locked” in the configuration, and can’t be changed regardless of the site. :baseline = Indicates if the object is part of the baseline configuration.</td>
</tr>
<tr>
<td>:created_at</td>
<td>Date when the subject type was created in the system.</td>
</tr>
<tr>
<td>:updated_at</td>
<td>Date when the subject type was last updated.</td>
</tr>
<tr>
<td>:created_by</td>
<td>User name who created this subject type.</td>
</tr>
<tr>
<td>:enabled</td>
<td>Enabled or disabled flag for this subject type.</td>
</tr>
<tr>
<td>:permission</td>
<td>The permissions available to this subject type.</td>
</tr>
<tr>
<td>:configuration</td>
<td>The subject type is part of the system configuration.</td>
</tr>
<tr>
<td>:fields_count</td>
<td>Number of user-defined fields in this Subject Type.</td>
</tr>
</tbody></table>
<h2 id='subjecttypegroup'>SubjectTypeGroup</h2>
<p>A user-defined group of subject types in the system:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of a subject type group.</td>
</tr>
<tr>
<td>:subject_types</td>
<td>The subject types associated with this group.</td>
</tr>
<tr>
<td>created_at</td>
<td>Date when the subject type group was created.</td>
</tr>
<tr>
<td>baseline</td>
<td>Indicates if the object is part of the baseline configuration.</td>
</tr>
<tr>
<td>updated_at</td>
<td>Date when the subject type group was last updated.</td>
</tr>
<tr>
<td>created_by:</td>
<td>User name who created this subject type group.</td>
</tr>
</tbody></table>
<h2 id='subject'>Subject</h2>
<p>Any user object in the system. Subjects are instances of a particular Subject Type:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:id</td>
<td>Unique ID of a subject.</td>
</tr>
<tr>
<td>:name</td>
<td>Subject name.</td>
</tr>
<tr>
<td>:barcode_tag</td>
<td>The unique barcode number assigned to the subject. :rid_tag = The unique RFID number assigned to the subject. :subject_type = Subject type name (Example: Bacteria or Sample).</td>
</tr>
<tr>
<td>:created_at</td>
<td>Date when the subject was created in the system.</td>
</tr>
<tr>
<td>:updated_at</td>
<td>Date when the subject was last updated.</td>
</tr>
<tr>
<td>:terminated</td>
<td>Flag if subject is terminated and no longer part of process/workflow. :user = Username of a subject owner.</td>
</tr>
<tr>
<td>:permission</td>
<td>The permissions available to this subject.</td>
</tr>
<tr>
<td>:flow_states</td>
<td>Workflow states which the object has been in.</td>
</tr>
<tr>
<td>:created_by</td>
<td>The user that created the subject.</td>
</tr>
<tr>
<td>:updated_by</td>
<td>The user that last updated the subject.</td>
</tr>
<tr>
<td>:udfs</td>
<td>The number and names of all user-defined fields associated with this subject.</td>
</tr>
</tbody></table>

<p><strong>List of API Functions</strong>
<aside class="notice">
Following is a list of Methods along with the returned objects they call along with any required, query, or control parameters to use with them. An explanation of each is as followed:
</aside></p>

<p><strong>Returned Objects</strong></p>

<p>LIMFINITY objects returned by API function.</p>

<p><strong>Required Parameters</strong></p>

<p>Necessary parameter or parameters for the method to run correctly. Without the required parameters an error message from the server should be expected. These will be written in the format required for the script along with placeholder text within the ‘ ’ marks.</p>

<p><strong>Optional Query parameters</strong></p>

<p>Optional parameters to control the results. These will be written in the format required for the script along with placeholder text within the ‘ ’ marks.</p>

<p><strong>Optional Control parameters</strong></p>

<p>Optional parameters to control the number and order of records in the output, and to implement paging of the results. These will be written in the format required for the script along with placeholder text within the ‘ ’ marks.</p>
<h2 id='audit'>audit</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #1 - This API will print the total number of Audit Records and list all related information.</span>
<span class="c1">#add any of the Optional query parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method=&gt; ''&gt;</span>
<span class="c1">#, :date_flag=&gt;'all/today/yesterday/week/month': Allows user to search for a specific date #, :date_range=&gt;'date from,date to': Allows user to search a specific date range</span>
<span class="c1">#, :subj_ids=&gt;'value,value': comma-separated Subject IDs to get audit records</span>
<span class="c1">#add any of the optional control parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method =&gt;''&gt;:</span>
<span class="c1">#, :start=&gt;'value': specifies what record to start listing from</span>
<span class="c1">#, :limit=&gt;'value': limit number of records to retrieve</span>
<span class="c1">#, :sort=&gt;'text': sort the records by a specific value</span>
<span class="c1">#, :dir=&gt;'ASC/DESC': sort the records in ascending or descending order</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'audit'</span><span class="c1">#Copy and paste optional query and/or control parameters here</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"AuditRecs"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Retrieves a list of audit records of every change made within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects:</strong></td>
<td>AuditRecs</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters:</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>:date_flag=&gt;’all/today/yesterday/week/month’</td>
<td>Displays audit records made today, yesterday, this week, or this month.</td>
</tr>
<tr>
<td></td>
<td>:date_range=&gt;’date_from,date_to’</td>
<td>Displays audit records made within a specific date range(format: mm/dd/yyyy).</td>
</tr>
<tr>
<td></td>
<td>:subj_ids=&gt;’value,value’</td>
<td>Displays audits records of a specific range of subjects.</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>:start=&gt;’value’</td>
<td>The item specific ID to start the list with.</td>
</tr>
<tr>
<td></td>
<td>:limit=&gt;&#39;value&#39;</td>
<td>The total number of items to retrieve.</td>
</tr>
<tr>
<td></td>
<td>:sort=&gt;&#39;text&#39;</td>
<td>Sort the displayed results by a specific field such as subject_type, subject_name, etc.</td>
</tr>
<tr>
<td></td>
<td>:dir=&gt;&#39;ASC/DESC&#39;</td>
<td>Sort the displayed results in ascending or descending order.</td>
</tr>
</tbody></table>
<h2 id='users-2'>users</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #2 - This API will print the total number of Users and list all related information.</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>
<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'users'</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"Users"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Retrieves a list of users within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Users</td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
</tr>
</tbody></table>
<h2 id='users_groups'>users_groups</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #3 - This API will print the total number of User Groups and list all related information.</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'user_groups'</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"Groups"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Retrieves a list of user groups within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Groups</td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
</tr>
</tbody></table>
<h2 id='roles'>roles</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #4 - This API will print the total number of Roles and list all related information.</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>
<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'roles'</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"Roles"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span> <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Retrieves a list of roles within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Roles</td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
</tr>
</tbody></table>
<h2 id='userfields'>userfields</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #5 - This API will print the total number of User Fields and list all related information. #add any of the Optional query parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method=&gt; ''&gt;</span>
<span class="c1">#, :query=&gt;'text': optional search string to filter the results.</span>
<span class="c1">#add any of the optional control parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method =&gt;''&gt;:</span>
<span class="c1">#, :start=&gt;'value': specifies what record to start listing from</span>
<span class="c1">#, :limit=&gt;'value': limit number of records to retrieve</span>
<span class="c1">#, :sort=&gt;'value': sort the records by a specific value</span>
<span class="c1">#, :dir=&gt;'ASC/DESC': sort the records in ascending or descending order</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'userfields'</span><span class="c1">#Copy and paste optional query and/or co ntrol parameters here</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"UserFields"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span> <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Retrieves a list of user-defined fields within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>UserFields</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>:query=&gt;’text’</td>
<td>Displays a list of user-defined fields containing a specific text string.</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>:start=&gt;’value’</td>
<td>The item specific ID to start the list with.</td>
</tr>
<tr>
<td></td>
<td>:limit=&gt;&#39;value&#39;</td>
<td>The total number of results to retrieve.</td>
</tr>
<tr>
<td></td>
<td>:sort=&gt;&#39;text&#39;</td>
<td>Sort the displayed results by a specific field such as subject_type, subject_name, etc.</td>
</tr>
<tr>
<td></td>
<td>:dir=&gt;&#39;ASC/DESC&#39;</td>
<td>Sort the displayed results in ascending or descending order.</td>
</tr>
</tbody></table>
<h2 id='subject_types'>subject_types</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #6 - This API will print the total number of Subject Types and any relevant information</span>
<span class="c1">#add any of the Optional query parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method=&gt; ''&gt;</span>
<span class="c1">#, :query=&gt;'text': optional search string to filter the results.</span>
<span class="c1">#add any of the optional control parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method =&gt;''&gt;:</span>
<span class="c1">#, :start=&gt;'value': specifies what record to start listing from</span>
<span class="c1">#, :limit=&gt;'value': limit number of records to retrieve</span>
<span class="c1">#, :sort=&gt;'value': sort the records by a specific value</span>
<span class="c1">#, :dir=&gt;'ASC/DESC': sort the records in ascending or descending order</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'subject_types'</span><span class="c1">#Copy and paste optional query and/or control parameters here</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"SubjectTypes"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span> <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="c1">#puts data</span>
</code></pre>
<p>Retrieves a list of subject types within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>SubjectTypes</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>:query=&gt;’text’</td>
<td>Displays a list of subject types containing a specific text string.</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>:start=&gt;’value’</td>
<td>The item specific ID to start the list with.</td>
</tr>
<tr>
<td></td>
<td>:limit=&gt;&#39;value&#39;</td>
<td>The total number of results to retrieve.</td>
</tr>
<tr>
<td></td>
<td>:sort=&gt;&#39;text&#39;</td>
<td>Sort the displayed results by a specific field such as subject_type, subject_name, etc.</td>
</tr>
<tr>
<td></td>
<td>:dir=&gt;&#39;ASC/DESC&#39;</td>
<td>Sort the displayed results in ascending or descending order.</td>
</tr>
</tbody></table>
<h2 id='subject_groups'>subject_groups</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #7 - This API will print the total number of Subject Type Groups and any relevant informatio n</span>
<span class="c1">#add any of the Optional query parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method=&gt; ''&gt;</span>
<span class="c1">#, :query=&gt;'text': optional search string to filter the results.</span>
<span class="c1">#add any of the optional control parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method =&gt;''&gt;:</span>
<span class="c1">#, :start=&gt;'value': specifies what record to start listing from</span>
<span class="c1">#, :limit=&gt;'value': limit number of records to retrieve</span>
<span class="c1">#, :sort=&gt;'value': sort the records by a specific value</span>
<span class="c1">#, :dir=&gt;'ASC/DESC': sort the records in ascending or descending order</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'subject_groups'</span><span class="c1">#Copy and paste optional query and/o r control parameters here</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"SubjectTypeGroups"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span> <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="c1">#puts data</span>
</code></pre>
<p>Retrieves a list of subject type groups within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>SubjectTypes</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>:query=&gt;’text’</td>
<td>Displays a list of subject type groups containing a specific text string.</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>:start=&gt;’value’</td>
<td>The item specific ID to start the list with.</td>
</tr>
<tr>
<td></td>
<td>:limit=&gt;&#39;value&#39;</td>
<td>The total number of results to retrieve.</td>
</tr>
<tr>
<td></td>
<td>:sort=&gt;&#39;text&#39;</td>
<td>Sort the displayed results by a specific field such as subject_type, subject_name, etc.</td>
</tr>
<tr>
<td></td>
<td>:dir=&gt;&#39;ASC/DESC&#39;</td>
<td>Sort the displayed results in ascending or descending order.</td>
</tr>
</tbody></table>
<h2 id='subjects'>subjects</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #8 - This API will print the total number of Subjects and any relevant information</span>
<span class="c1">#add any of the Optional query parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method=&gt; ''&gt;</span>
<span class="c1">#, :subject_ids=&gt;'value': limit subjects to a list of IDs</span>
<span class="c1">#, :subject_names=&gt;'text': limit subjects to a list of names</span>
<span class="c1">#, :user_fields=&gt;'text': comma-delimited list of User Defined fields to retrieve for subjects #, :query=&gt;'text': optional search string to filter the results.</span>
<span class="c1">#add any of the optional control parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method =&gt;''&gt;:</span>
<span class="c1">#, :start=&gt;'value': specifies what record to start listing from</span>
<span class="c1">#, :limit=&gt;'value': limit number of records to retrieve</span>
<span class="c1">#, :sort=&gt;'value': sort the records by a specific value</span>
<span class="c1">#, :dir=&gt;'ASC/DESC': sort the records in ascending or descending order</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'subjects'</span><span class="p">,</span> <span class="ss">:subject_type</span><span class="o">=&gt;</span><span class="s1">'Patient'</span><span class="c1">#Copy and paste optional query and/or control parameters here</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="nb">puts</span> <span class="n">data</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"Subjects"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span> <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="c1">#puts data</span>
</code></pre>
<p>Retrieves a list of subjects within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Subjects</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:subject_type=&gt;’value/text’</td>
<td>Limits the search to all subjects of a specific type(can use subject type name or specific ID).</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>:subject_ids=&gt;’value,value’</td>
<td>Limits subjects to a list of item specific IDs.</td>
</tr>
<tr>
<td></td>
<td>:subject_names=&gt;’text,text’</td>
<td>Limits subjects to a list of item specific names.</td>
</tr>
<tr>
<td></td>
<td>:query=&gt;’text’</td>
<td>Displays a list of subjects containing a specific text string.</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>:start=&gt;’value’</td>
<td>The item specific ID to start the list with.</td>
</tr>
<tr>
<td></td>
<td>:limit=&gt;&#39;value&#39;</td>
<td>The total number of results to retrieve.</td>
</tr>
<tr>
<td></td>
<td>:sort=&gt;&#39;text&#39;</td>
<td>Sort the displayed results by a specific field such as subject_type, subject_name, etc.</td>
</tr>
<tr>
<td></td>
<td>:dir=&gt;&#39;ASC/DESC&#39;</td>
<td>Sort the displayed results in ascending or descending order.</td>
</tr>
</tbody></table>
<h2 id='delete_subject'>delete_subject</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #9 - This API will delete a Subject as specified by ID or a combination of subject_type/subj ect_name</span>
<span class="c1">#add any of the Optional query parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method=&gt; ''&gt;</span>
<span class="c1">#, :subject_type=&gt;'value': subject type ID</span>
<span class="c1">#, :subject_name=&gt;'text': subject name</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span>  <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>
<span class="n">req</span>  <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                      <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'delete_subject'</span><span class="p">,</span> <span class="ss">:id</span><span class="o">=&gt;</span><span class="s1">'13'</span><span class="c1">#replace &lt;:id=&gt;'value '&gt; with &lt;:subject_type=&gt;'value', :subject_name=&gt;'text'&gt; for optional query parameters</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"-------------------"</span>
<span class="nb">puts</span> <span class="n">data</span><span class="p">.</span><span class="nf">to_json</span>
<span class="nb">puts</span> <span class="s2">"-------------------"</span>
</code></pre>
<p>Deletes a subject as specified by ID.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:id=&gt;’value’</td>
<td>The specific ID of the subject to be deleted, OR</td>
</tr>
<tr>
<td></td>
<td>:subject_type=&gt;’value/text’</td>
<td>Limits the search to all subjects of a specific type(can use subject type name or specific ID).</td>
</tr>
<tr>
<td></td>
<td>:subject_name=&gt;’text’</td>
<td>Limits the search to all subjects matching the specified name</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
</tbody></table>
<h2 id='gen_token'>gen_token</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #10 - This API will generate and print an "auth_token" to be used instead of a user's pass word. Using the auth_token will omit the API Session Created</span>
<span class="c1"># and API Session Removed  entries in the audit log</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks = Net::HTTP::Post::Multipart.new url.path,</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'gen_token'</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">str</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">body</span>
<span class="nb">puts</span> <span class="n">str</span> <span class="c1">#Output the generated authentication token</span>
</code></pre>
<p>Creates an “auth_token” to be used instead of a user’s password. Using the auth_token will omit the “API Session Created” and “API Session Removed” entries in the audit log.</p>

<aside class="notice">
<b>Note:</b> Generated Authorization Tokens are only valid for 10 minutes after they are either generated or last used. If an expired or invalid token is used, the following error message should be displayed: “Invalid Token”.
</aside>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Auth_token</td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
</tr>
</tbody></table>
<h2 id='subject_details'>subject_details</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #11 - This API will Print all details of a Subject as specified by ID, Barcode, and RFID</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks 8.</span>
<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'subject_details'</span><span class="p">,</span> <span class="ss">:subject_id</span><span class="o">=&gt;</span><span class="s1">'9'</span><span class="p">,</span>
                                     <span class="ss">:barcode_tag</span><span class="o">=&gt;</span><span class="s1">'L04000009'</span><span class="p">,</span> <span class="ss">:rfid_tag</span><span class="o">=&gt;</span><span class="s1">'355AB1CBC000004000000009'</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>

<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="nb">puts</span> <span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">value</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>
<p>Deletes a subject as specified by ID.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>A list of values corresponding to a specific subject</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:id=&gt;’value’</td>
<td>The specific ID of the subject to be displayed.</td>
</tr>
<tr>
<td></td>
<td>:barcode_tag=&gt;’value’</td>
<td>The specific barcode tag of the subject to be displayed.</td>
</tr>
<tr>
<td></td>
<td>:rfid_tag =&gt;value</td>
<td>The specific RFID tag of the subject to be displayed.</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
</tbody></table>
<h2 id='run_script'>run_script</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example 12 - This API will execute a run_script / helper script by specifying the name of the script in the system and the data which should be passted to it.</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://demo.limfinity.com/api'</span><span class="p">)</span> <span class="mi">8</span><span class="p">.</span>
    <span class="nf">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span> <span class="ss">:username</span><span class="o">=&gt;</span> <span class="s2">"admin"</span><span class="p">,</span>
                                         <span class="ss">:password</span><span class="o">=&gt;</span> <span class="s2">"admin"</span><span class="p">,</span>
                                         <span class="ss">:name</span><span class="o">=&gt;</span> <span class="s2">"demo_helper_script"</span><span class="p">,</span>
                                         <span class="ss">:data</span><span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">"Name"</span><span class="p">:</span> <span class="s2">"Sample 1"</span><span class="p">,</span> <span class="s2">"BARCODE"</span><span class="p">:</span> <span class="s2">"123456"</span><span class="p">,</span> <span class="s2">"Specimen Name"</span><span class="p">:</span> <span class="s2">"Specimen 1"</span><span class="p">,</span> <span class="s2">"Created"</span><span class="p">:</span> <span class="s2">"10/28/2014"</span><span class="p">,</span> <span class="s2">"Created By"</span><span class="p">:</span> <span class="s2">"User 1"</span><span class="p">,</span> <span class="s2">"Current Amount"</span><span class="p">:</span> <span class="mi">10</span><span class="o">.</span><span class="mi">2</span> <span class="p">}</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">star</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="n">data</span><span class="p">.</span><span class="nf">to_json</span>
</code></pre>
<p>Allows the running of a helper script by name and the passing of arbitrary JSON-formatted parameters to that script.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Helper script-returned serialized JSON</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:name=&gt;’helper_script_name’</td>
<td>The name of the helper script to be run.</td>
</tr>
<tr>
<td></td>
<td>:data=&gt;’’</td>
<td>Arbitrary data to be passed to the script represented as a JSON object(s) of a string wit JSON-encoded object(s). This data will be accessible in the script as data.</td>
</tr>
</tbody></table>

<p>The script will also have access to all HTTP request parameters specified in the request using <code>params[:parameter_name]</code> syntax</p>

<p>This function differs from all other API functions by how it should be called. Instead of passing <code>run_script</code> as a value for the “method” parameter, is requires a special URL in the following form:  <code>http://{LIMS_ADDR}:{LIMS_PORT}/api/run_script</code></p>

<p><a href="http://demo.lims247.com/api/run_Script">Example</a></p>
<h2 id='search_subjects'>search_subjects</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #13 - This API will search for a Subject by variables such as Subject Type, Search Mode, Use r Fields, and texts strings.</span>
<span class="c1">#add any of the optional control parameters by copy and pasting &lt;, :function=&gt;'value'&gt; after &lt;:method =&gt;''&gt;:</span>
<span class="c1">#, :start=&gt;'value': specifies what record to start listing from</span>
<span class="c1">#, :limit=&gt;'value': limit number of records to retrieve</span>
<span class="c1">#, :sort=&gt;'value': sort the records by a specific value</span>
<span class="c1">#, :dir=&gt;'ASC/DESC': sort the records in ascending or descending order</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks)</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span>
                                     <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'search_subjects'</span><span class="p">,</span> <span class="ss">:subject_type</span><span class="o">=&gt;</span><span class="s1">'Client'</span><span class="p">,</span> <span class="ss">:search_mode</span><span class="o">=&gt;</span><span class="s1">'REGULAR'</span><span class="p">,</span>
                                     <span class="ss">:user_fields</span><span class="o">=&gt;</span><span class="s1">'Address, Phone Number'</span><span class="p">,</span>
                                     <span class="ss">:fields</span><span class="o">=&gt;</span><span class="s1">'Subject Name'</span><span class="p">,</span> <span class="ss">:conditions</span><span class="o">=&gt;</span><span class="s1">'contains'</span><span class="p">,</span> <span class="ss">:values</span><span class="o">=&gt;</span><span class="s1">'ruro'</span><span class="c1">#Copy and paste optional control par ameters here</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"Subjects"</span>
    <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">each</span> <span class="k">do</span>
      <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span> <span class="o">+</span><span class="s2">":"</span><span class="o">+</span><span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Retrieves a subject or list of specified subjects.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Subjects</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:search_mode=&gt;’REGULAR/DEEP’</td>
<td>Specifies the type of search to be performed.</td>
</tr>
<tr>
<td></td>
<td>:subject_type=&gt;’value/text’</td>
<td>Limits the search to all subjects of a specific type(can use subject type name or specific ID, Example: ‘Client’).</td>
</tr>
<tr>
<td></td>
<td>:user_fields=&gt;’text,text’</td>
<td>Comma delimited list of User-defined fields to retrieve for the searched subject(s)(Example: ‘Address, Phone Number’).</td>
</tr>
<tr>
<td></td>
<td>:fields=&gt;’text’</td>
<td>fields to search within the subject(Example: ‘Subject Name’)</td>
</tr>
<tr>
<td></td>
<td>:conditions=&gt;’text’</td>
<td>The conditions that will be applied to the search subject. :values=&gt;’value/text’ = Specific strings within the subject to be searched for.</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>:start=&gt;’value’</td>
<td>The item specific ID to start the list with.</td>
</tr>
<tr>
<td></td>
<td>:limit=&gt;&#39;value&#39;</td>
<td>The total number of results to retrieve.</td>
</tr>
<tr>
<td></td>
<td>:sort=&gt;&#39;text&#39;</td>
<td>Sort the displayed results by a specific identifier such as subject_type, subject_name, etc.</td>
</tr>
<tr>
<td></td>
<td>:dir=&gt;&#39;ASC/DESC&#39;</td>
<td>Sort the displayed results in ascending or descending order.</td>
</tr>
</tbody></table>
<h2 id='import_subjects-via-csv'>import_subjects via CSV</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #14 - This API will import Subjects based on a CSV filerequire 'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks) 8.</span>

<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">"./clients.csv"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">the_csv</span><span class="o">|</span>

  <span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                       <span class="ss">:file</span><span class="o">=&gt;</span> <span class="no">UploadIO</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">the_csv</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">,</span> <span class="s2">"clients.csv"</span><span class="p">),</span> <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span>
                                       <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'import_subjects'</span><span class="p">,</span> <span class="ss">:subject_type</span><span class="o">=&gt;</span><span class="s1">'Client'</span>

  <span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
    <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
  <span class="nb">puts</span> <span class="s2">"Total Success"</span> <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">'success'</span><span class="p">]</span>
  <span class="nb">puts</span> <span class="n">data</span><span class="p">[</span><span class="s1">'message'</span><span class="p">]</span> <span class="c1">#success or error message will be printed here</span>
<span class="k">end</span>

</code></pre>
<p>Imports a subject or subjects along with specified fields from a CSV file.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Subjects</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:file=&gt;’.CSV file’</td>
<td>File to import(Must be CSV format).</td>
</tr>
<tr>
<td></td>
<td>:subject_type=&gt;’value/text”</td>
<td>The specific type of the subject or subjects to be imported.</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
</tbody></table>
<h2 id='import_subjects-via-json'>import_subjects via JSON</h2>
<p>Imports a subject or subjects along with specified fields specified by subjects in JSON format</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:json=&gt;’’</td>
<td>String of LIMFINITY subjects in JSON format.</td>
</tr>
<tr>
<td></td>
<td>:subject_type=&gt;’value/text”</td>
<td>The specific type of the subject or subjects to be imported.</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
</tbody></table>
<h2 id='upload_file_udf'>upload_file_udf</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #15 - This API will upload a file to a Subject as specified by ID</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://your-limfinity-url/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks)</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s1">'C:\Users\Louis\Desktop\New Limfinity API Guide Examples\clients.csv'</span>

<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">fname</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>

  <span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                       <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'upload_file_udf'</span><span class="p">,</span>
                                       <span class="ss">:file</span><span class="o">=&gt;</span> <span class="no">UploadIO</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">,</span> <span class="n">fname</span><span class="p">),</span> <span class="ss">:id</span><span class="o">=&gt;</span><span class="s1">'2'</span><span class="p">,</span> <span class="ss">:udf_name</span><span class="o">=&gt;</span><span class="s1">'File'</span>

  <span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
    <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="n">str</span> <span class="o">=</span> <span class="n">res</span><span class="p">.</span><span class="nf">body</span>
  <span class="nb">puts</span> <span class="n">str</span>
<span class="k">end</span>
</code></pre>
<p>Uploads a file containing user-defined fields to the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:udf_name=&gt;’ text’</td>
<td>Name of the file to be uploaded.</td>
</tr>
<tr>
<td></td>
<td>:file=&gt;’text’</td>
<td>The content of the file to be uploaded.</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
</tbody></table>
<h2 id='get_pedigree_data'>get_pedigree_data</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #16 - This API will print the pedigree data of a Subject as specifed by ID</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>
<span class="err">​</span>
<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://demo.limfinity.com/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks)</span>
<span class="err">​</span>
<span class="err">​</span>
<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:password</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'get_pedigree_data'</span><span class="p">,</span>
                                     <span class="ss">:subject_type</span><span class="o">=&gt;</span><span class="s1">'Patient'</span><span class="p">,</span> <span class="ss">:subject_id</span><span class="o">=&gt;</span><span class="s1">'12345'</span>
<span class="err">​</span>
<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>
<span class="err">​</span>
<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="err">​</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each_pair</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Numeric</span><span class="p">)</span> <span class="c1">#has assigned patient</span>
    <span class="n">patient</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="ss">:Individual</span><span class="p">]</span>
    <span class="n">father</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="ss">:Father</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">father</span>
      <span class="n">father_id</span> <span class="o">=</span> <span class="n">father</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Subject</span><span class="p">)</span> <span class="p">?</span> <span class="n">father</span><span class="p">.</span><span class="nf">id</span> <span class="p">:</span> <span class="n">father</span>
      <span class="n">father_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">father_id</span><span class="p">]</span>
      <span class="nb">puts</span> <span class="n">father_data</span> <span class="c1">#output father data</span>
    <span class="k">end</span>
    <span class="n">mother</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="ss">:Mother</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">mother</span>
      <span class="n">mother_id</span> <span class="o">=</span> <span class="n">mother</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">Subject</span><span class="p">)</span> <span class="p">?</span> <span class="n">mother</span><span class="p">.</span><span class="nf">id</span> <span class="p">:</span> <span class="n">mother</span>
      <span class="n">mother_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mother_id</span><span class="p">]</span>
      <span class="nb">puts</span> <span class="n">mother_data</span> <span class="c1">#output mother data</span>
    <span class="k">end</span>
  <span class="k">else</span> <span class="c1">#No assigned patient</span>
    <span class="nb">puts</span> <span class="s2">"No assigned patient"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>Retrieves the pedigree data of one family within the system.</p>

<table><thead>
<tr>
<th>Property</th>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><strong>Returned Objects</strong></td>
<td>Key/value pair pf pedigree node subject and its information.</td>
<td></td>
</tr>
<tr>
<td><strong>Required Parameters</strong></td>
<td>:family_subject=&gt;’value/text’</td>
<td>Family subject type(can use subject type name or specific ID).</td>
</tr>
<tr>
<td></td>
<td>:pedigree_prop=&gt;’text’</td>
<td>Pedigree type user-defined field or its name(not required if there is only one user-defined field for this type</td>
</tr>
<tr>
<td><strong>Optional Query Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
<tr>
<td><strong>Optional Control Parameters</strong></td>
<td>None</td>
<td></td>
</tr>
</tbody></table>
<h3 id='returned-hash-values'>Returned Hash Values</h3>
<p>he key is an individual ID of a pedigree node. The key is the numeric subject ID for the pedigree nodes with the assigned subject, or a string otherwise. The value is a hash with the following content(each pair is optional).</p>

<table><thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>:Individual</td>
<td>Assigned subject.</td>
</tr>
<tr>
<td>:Mother</td>
<td>Subject if the mother node has an assigned subject; String ID otherwise.</td>
</tr>
<tr>
<td>:Father</td>
<td>Subject if the father node has an assigned subject; String ID otherwise.</td>
</tr>
<tr>
<td>:Gender</td>
<td>‘Male’ or ‘Female’.</td>
</tr>
<tr>
<td>:Sampled, :MZTwin, :DZTwin, :Proband, :Deceased, :Consultand, :Carrier, :Affected</td>
<td>Same as in the standard PED format.</td>
</tr>
<tr>
<td>:terminated_pregnancy</td>
<td>“true” if the pregnancy was terminated.</td>
</tr>
<tr>
<td>:adopted_in</td>
<td>“true” if the individual was adopted in</td>
</tr>
<tr>
<td>:adopted_out</td>
<td>“true” if the individual was adopted out.</td>
</tr>
</tbody></table>
<h2 id='using-auth-token'>Using auth Token</h2><pre class="highlight ruby tab-ruby"><code><span class="c1">#Example #17 - The purpose of this API is to test if an auth token generated by "Example 10 Gen Token.rb" works as intended if used instead of a password.</span>
<span class="nb">require</span> <span class="s1">'rubygems'</span>
<span class="nb">require</span> <span class="s1">'json'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'net/http/post/multipart'</span>

<span class="n">url</span> <span class="o">=</span> <span class="no">URI</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'http://demo.limfinity.com/api'</span><span class="p">)</span><span class="c1">#Copy and paste actual URL within the '' marks</span>

<span class="n">req</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="o">::</span><span class="no">Post</span><span class="o">::</span><span class="no">Multipart</span><span class="p">.</span><span class="nf">new</span> <span class="n">url</span><span class="p">.</span><span class="nf">path</span><span class="p">,</span>
                                     <span class="ss">:username</span><span class="o">=&gt;</span><span class="s1">'admin'</span><span class="p">,</span> <span class="ss">:auth_token</span><span class="o">=&gt;</span><span class="s1">'9bdc7e45-e541-4867-9077-6ff181876118'</span><span class="p">,</span> <span class="ss">:method</span><span class="o">=&gt;</span><span class="s1">'users'</span><span class="c1">#copy and paste generated auth token in &lt;:auth_token=&gt;''&gt;</span>

<span class="n">res</span> <span class="o">=</span> <span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="n">url</span><span class="p">.</span><span class="nf">host</span><span class="p">,</span> <span class="n">url</span><span class="p">.</span><span class="nf">port</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">http</span><span class="o">|</span>
  <span class="n">http</span><span class="p">.</span><span class="nf">request</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">data</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">res</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">'Total'</span><span class="p">]</span>
<span class="nb">puts</span> <span class="n">total</span>
<span class="nb">puts</span> <span class="n">data</span>
<span class="n">data</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="o">|</span>
  <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">"Users"</span>
    <span class="n">value</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">types</span><span class="o">|</span>
      <span class="nb">puts</span> <span class="s2">"--------------"</span>
      <span class="n">types</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="nf">to_s</span> <span class="o">+</span> <span class="s2">": "</span> <span class="o">+</span> <span class="n">v</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
<p>This example is not linked to a corresponding method. The purpose of this example is to demonstrate how to use an auth token returned by “Example 10 Gen Token.rb”.
<aside class="notice">
<b>Note:</b> Auth tokens are only valid for ten minutes after they have either been created or last used. If an expired or invalid token is used, the following error message should be displayed: “Invalid Token”.
</aside></p>
<pre class="highlight ruby tab-ruby"><code><span class="n">suffix</span> <span class="o">=</span> <span class="n">subj</span><span class="p">.</span><span class="nf">get_value</span><span class="p">(</span><span class="s1">'Program Identifier'</span><span class="p">)</span>
<span class="n">url</span><span class="o">=</span> <span class="s1">'https://clinicaltrialsapi.cancer.*9'</span>
</code></pre><h2 id='calling-external-apis-with-limfinity'>Calling External APIs with Limfinity</h2>
<p>User can use call_external_service in After Script with optional :get, :post(default), and :put to specify the HTTP methods</p>
<h1 id='guides'>Guides</h1><h1 id='modelling-your-data-with-limfinity'>Modelling your data with Limfinity</h1>
<p>This guide walks you through the process of replicating your data model with Limfinity. In this guide you&#39;ll learn how to:</p>

<ul>
<li>Create a new subject type</li>
<li>Create a subject</li>
<li>Create new user-defined-fields</li>
<li>Configuring grid options for a subject</li>
</ul>

<p>In the sections below, we&#39;ll create a &quot;Patient&quot; subject that will be linked to a &quot;Sample.</p>
<h2 id='step-1-create-a-new-subject-type'>Step 1: Create a new Subject Type</h2>
<p>A <code>Subject Type</code> defines the type of data you can store. Think of it as a form, or a table.</p>

<p>Each subject type is annotated with <code>user-defined fields</code> (UDFs) that capture the metadata for that object. Each instance of a subject type is called a subject.</p>

<ol>
<li>Log in and click on Settings and Preferences</li>
<li>Click on Subject Types</li>
<li>Click the plus button to create a new Subject Type New Subject Type
<img src="images/guides/new_subject_type.png" alt="New Subject Type" /></li>
<li>Name your Subject Type &quot;Patient&quot; and specify the <code>Plural Name</code> - Patients
<img src="images/guides/plural_name.png" alt="Plural Name" /></li>
<li>Click <strong>OK</strong> to save</li>
</ol>
<h2 id='step-2-adding-user-defined-fields-to-your-subject-type'>Step 2: Adding User-Defined-Fields to your Subject Type</h2>
<p>Now we have a new &quot;Patient&quot; subject type, but it has no fields. Let&#39;s add a couple:</p>

<ol>
<li>Click on the &quot;Patient&quot; subject type</li>
<li>Click on the <code>Add User Defined Field</code> button and choose <code>Date</code> as the field type</li>
<li>Enter &quot;DOB&quot; for the User Field Name and check <code>Advanced Search</code>
<img src="images/guides/new_udf.png" alt="New UDF" /></li>
<li>Let&#39;s add a couple other fields: Phone Number (Text Field), Consent Signed (Checkbox), Gender (Choice - Male, Female, Both), Comments (Text Area)</li>
<li>Click <strong>OK</strong> to Save </li>
</ol>

<aside class="notice">
Note that it is necessary to check <b>Advanced Search</b> in order to make the field available in queries
</aside>

<p>Let&#39;s also create another subject type and name it &quot;Sample&quot; with the field Amount (Numeric). What we want to do now is to link the sample to the patient it has been collected from.</p>

<ol>
<li>Open the &quot;Sample&quot; subject type</li>
<li>Click on <code>Add User Defined Field</code> button and choose <code>Limfinity</code> -&gt; <code>Subject</code> as the field type</li>
<li>Enter &quot;Patient&quot; as the User Field Name and select <code>Patient</code> as the `Subject Type
<img src="images/guides/subject_udf_patient.png" alt="New UDF" /></li>
<li>Click <strong>OK</strong> to Save</li>
</ol>
<h2 id='step-3-creating-a-subject'>Step 3: Creating a subject</h2>
<p>Our &#39;Patient&#39; subject type has fields defined, but we do not yet have any actual patients. </p>

<p>Let&#39;s make a patient:</p>

<ol>
<li>Click on <code>Explorer</code></li>
<li>Click on Patients</li>
<li>Click the plus button to add a new subject</li>
<li>Enter values for DOB, Gender, Consent Signed, Phone number, Comments and click OK to save the new subject
<img src="images/guides/new_patient.png" alt="New UDF" /></li>
</ol>
<h2 id='configuring-the-subject-type-grid'>Configuring the subject type grid</h2>
<p>Our newly added fields are not  yet showing up on patient result grids. Let&#39;s configure the grid and add our new fields:
<aside class="notice">
Configuring grid View Options allows you to specify which columns should be shown in a grid for that subject as well as the order/width of the columns.
</aside></p>

<ol>
<li>Click on <code>Settings and Preferences</code></li>
<li>Click on <code>Subject Types</code></li>
<li>Select Patient and click <code>View Options</code></li>
<li>Add fields DOB, Gender, Phone Number, Consent Signed and Comments</li>
<li>Remove the UID field</li>
<li>Move the fields DOB, Gender, Phone Number and Consent Singed to the top and click <strong>OK</strong>
<img src="images/guides/grid_config.png" alt="New UDF" /></li>
</ol>
<h1 id='creating-workflows'>Creating workflows</h1>
<p>This guide walks you through the process of creating a workflow. In this guide you will learn how to:</p>

<ul>
<li>Create a new new workflow</li>
<li>Create workflow states</li>
<li>Add tools to a workflow</li>
<li>Take a subject through a workflow</li>
</ul>

<p>In the sections below, we&#39;ll create an &quot;Issue&quot; workflow. Let&#39;s start by creating an &quot;Issue&quot; subject type with fields:</p>

<ol>
<li>Description (Text Area)</li>
<li>Status (Choice)</li>
<li>Assignee (User)</li>
<li>Resolved Date (Date)</li>
</ol>
<h2 id='step-1-create-a-new-workflow'>Step 1: Create a new Workflow</h2>
<p>Each workflow can only be attached to one single subject type, but subject types can belong to multiple workflows. A workflow describes how subjects go through processes and what actions are available for each state</p>

<ol>
<li>Click on <code>Settings and Preferences</code></li>
<li>Click on the plus button and select the desired subject type (&quot;Issue)
<aside class="notice">
If you just created a new subject type, you will need to refresh the page for it to show up in the dropdown
</aside></li>
<li>Enter a name for the workflow. The convention is to name it the same as the subject type, so let&#39;s put in &quot;Issue&quot; as the worklfow name</li>
<li>Click on the workflow to open it in the workflow editor window
<img src="images/guides/new_workflow.png" alt="New UDF" /></li>
</ol>
<h2 id='step-2-add-states'>Step 2: Add states</h2>
<p>We have a brand new &quot;Issue&quot; workflow, but it has no states. Each record in the workflow will go through a sequence of states that model the workflow.
For our &quot;Issue&quot; workflow, we know that it can either be &quot;Open&quot; or &quot;Resolved&quot;. 
1. Click on the plus button to add a new state
<img src="images/guides/new_workflow_state.png" alt="New UDF" />
2. Let&#39;s call the new state &quot;Open&quot;. This new state will appear on the canvas. By default, this state will be the entry state for all new subjects in the &quot;Issue&quot; workflow, but you can always change the first state by specifying a new &quot;Entry State&quot; in workflow editor
3. Create another state called &quot;Resolved&quot;
<img src="images/guides/resolved_state.png" alt="New UDF" /></p>
<h2 id='step-3-adding-a-workflow-transition'>Step 3: Adding a workflow transition</h2>
<p>Now that we have both &quot;Open&quot; and &quot;Resolved&quot; states, let&#39;s link it together. To do this, you will need to create a tool (it can be any type of tool)
1. Click on the plus button in the <code>Tools</code> tab
2. Give your tool a name, and a title. <code>Name</code> is the internal identifier, while <code>Title</code> is the user-facing value
3. Specify the <code>Input Subject Type</code> = Issue
4. Specify the <code>Workflow Transition</code> = Resolved
5. Drag the tool into the &quot;Open&quot; state
<img src="images/guides/transition.png" alt="New UDF" />
5. You should now see an arrow stretch the &quot;Open&quot; state to the &quot;Resolved&quot; state
<img src="images/guides/linked_states.png" alt="New UDF" /></p>

<p>Let&#39;s add another tool to create a new Issue:</p>

<ol>
<li>Create a <code>Create New Subject</code> tool and name it &quot;New Issue&quot;</li>
<li>Fill out the <code>Name</code>, <code>Title</code>, <code>Output Subject Type</code>, and <code>Workflow</code></li>
<li>Click <code>OK</code> to create a new Issue record</li>
</ol>
<h2 id='step-4-adding-tool-groups'>Step 4: Adding tool groups</h2>
<p>Starting with Limfinity 7.1 you can now reuse individual tools or multiple tools in many workflows by placing them into tool groups. Tool groups can be used in many places such as <code>Quick Links</code> (buttons that appear in the left nav bar) or workflows.</p>

<p>To create a toolgroup:</p>

<ol>
<li>Click on the plus button in the <code>Tool Groups</code> tab</li>
<li>Fill out the <code>Name</code> = Issues and the <code>Title</code> = Issues fields
<img src="images/guides/new_tool_group.png" alt="New UDF" /></li>
<li>You can specify whether to display the tool group as a quick link, or as a set of buttons on the workflow state. Let&#39;s place this toolgroup in the Quick Links bar.</li>
<li>Add the &quot;Resolve&quot; and the &quot;New Issue&quot; tools to this tool group</li>
<li>Refresh to see a folder with the workflow tools</li>
</ol>
<h2 id='step-5-taking-a-subject-record-through-a-workflow'>Step 5: Taking a subject record through a workflow</h2>
<p>Let&#39;s take an Issue from being open to resolution:</p>

<ol>
<li>Click on <code>Explorer</code>. and select <code>Issues</code></li>
<li>Click <code>New Issue</code></li>
<li>A &quot;New Issue&quot; dialog will open</li>
<li>Fill out the data to create a new Issue</li>
<li>Upon saving, the page for the new record will open and you should see a &quot;Resolve&quot; button on the right of the page</li>
</ol>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="ruby">ruby</a>
          </div>
      </div>
    </div>
  </body>
</html>
